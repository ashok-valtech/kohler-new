function onAjaxError(customMsg){customMsg.length>0&&$("#failureMessage").html(customMsg),$("#hk-digital-from-btn").removeClass("koh-form-btn-loader"),$(".koh-upload-wrapper").show(),$("form").find("input[type=text], input[type=file], textarea, select").val(""),$("#failureMessage").removeClass("hide").fadeIn("fast"),setTimeout(function(){$("#failureMessage").fadeOut(messageFadingTimingLink,function(){$(this).addClass("hide")})},messageTimingLink)}function dateFormattingtoHKLocale(submissionDate){var hongKongDateTime=submissionDate.toLocaleString("en-US",{timeZone:"Asia/Hong_Kong",weekday:"short",year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),offsetHours=8,sign=offsetHours>=0?"+":"",offsetString=String(Math.abs(offsetHours));offsetString.length<2&&(offsetString="0"+offsetString);var gmtString="GMT"+sign+offsetString+"00",timeZoneName="(Hong Kong Standard Time)",dateString=hongKongDateTime+" "+gmtString+" "+timeZoneName,finalDateString=dateString.replace(/,/g,"");return finalDateString}function validateContactForm(contactEmailLink){var name=$("#hk-digital-form-name").val(),emailAddress=$("#hk-digital-form-email-address").val(),mobileNumber=$("#hk-digital-form-mobile-number").val(),bathroomFixture=$("#koh-bathroom-fixtures").val(),interestProduct=$("#koh-interest-products").val(),thankyouPage=$("#hk-digital-ThankyouPage").val(),isValid=!0;if((""==bathroomFixture||null==bathroomFixture)&&(isValid=!1,showError("#koh-bathroom-fixtures",bathroomFixtureErrorMessage)),(""==interestProduct||null==interestProduct)&&(isValid=!1,showError("#koh-interest-products",interestedProductErrorMessage)),(""==name||null==name)&&(isValid=!1,showError("#hk-digital-form-name",firstNameErrorMessageLink)),(""==emailAddress||null==emailAddress)&&(isValid=!1,showError("#hk-digital-form-email-address",emailErrorMessageLink)),""==mobileNumber&&(isValid=!1,showError("#hk-digital-form-mobile-number",mobileErrorMessageLink)),0==document.getElementById("kohler-warranty-privacy-policy").checked&&(isValid=!1,showError("#hk-privacy-label",privacyErrorMessage)),1==isValid){var curDate=new Date,formattedDate=dateFormattingtoHKLocale(curDate),fdata=new FormData;fdata.append("koh-bathroom-fixtures",bathroomFixture),fdata.append("koh-interest-products",interestProduct),fdata.append("hk-digital-form-name",name),fdata.append("hk-digital-form-email-address",emailAddress),fdata.append("hk-digital-form-mobile-number",mobileNumber),fdata.append("hk-digital-form-submission-date",formattedDate),$.ajax({url:contactEmailLink,cache:!1,contentType:!1,processData:!1,data:fdata,type:"POST",beforeSend:function(){$("#hk-digital-from-btn").addClass("koh-form-btn-loader")},success:function(data){if("true"==data.success)window.open(thankyouPage,"_self");else if(data.sfmcAPIError)onAjaxError(data.sfmcAPIError);else{var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}},error:function(error){var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}})}}var firstNameErrorMessageLink=$("#nameErrorMessageLink").val(),emailErrorMessageLink=$("#emailErrorMessageLink").val(),mobileErrorMessageLink=$("#mobileErrorMessageLink").val(),emailErrorMessageLink2=$("#emailErrorMessageLink2").val(),mobileErrorMessageLink2=$("#mobileErrorMessageLink2").val(),messageTimingLink=$("#messageTimingLink").val(),messageFadingTimingLink=$("#messageFadingTimingLink").val(),privacyErrorMessage=$("#privacyErrorMessage").val(),bathroomFixtureErrorMessage=$("#bathroomFixtureErrorMessage").val(),interestedProductErrorMessage=$("#interestedProductErrorMessage").val(),disableSubmit=function(errorCount){errorCount>0?$("#hk-digital-from-btn").attr("disabled",!0):$("#hk-digital-from-btn").removeAttr("disabled")};$(document).ready(function(){$(".hk-digital-checkbox").first().prop("checked",!0),$("#hkDigitalLeadForm").submit(function(e){e.preventDefault();var contactEmailLink=$(this).attr("action");validateContactForm(contactEmailLink)})});var showError=function(ele,errorMessage){$(ele).parent().find(".koh-error").remove(),$(ele).after("<div class='koh-error'>"+errorMessage+"</div>"),$(ele).css({"border-color":"#e7102e"}),$(ele).closest(".form-group").css({"margin-bottom":"6px"}),disableSubmit(1)},removeError=function(ele){$(ele).parent().find(".koh-error").remove(),$(ele).css({"border-color":"#cccccc"}),$(ele).closest(".form-group").css({"margin-bottom":"15px"});var sfmcErrorCount=$(document).find(".koh-error").size();disableSubmit(sfmcErrorCount)},validateEmail=function(ele){var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,currentVal=$(ele).val();return 0==reg.test(currentVal)?!1:!0};$("#hk-digital-form-mobile-number").on("input",function(event){var start=this.selectionStart-1,end=this.selectionEnd-1;$(this).val().match(/[^0-9-+()]/gi)&&($(this).val($(this).val().replace(/[^0-9-+()]/gi,"")),this.setSelectionRange(start,end))}),$(document).on("keyup change","#hkDigitalLeadForm input, #hkDigitalLeadForm select, #hkDigitalLeadForm textarea",function(e){var currentIdName=$(this).attr("id"),currentId="#"+currentIdName;if("hk-digital-form-name"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,firstNameErrorMessageLink)):(isValid=!0,removeError(currentId))}if("hk-digital-form-email-address"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,emailErrorMessageLink)):validateEmail(currentId)?(isValid=!0,removeError(currentId)):(isValid=!1,showError(currentId,emailErrorMessageLink2))}if("hk-digital-form-mobile-number"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,mobileErrorMessageLink)):(isValid=!0,removeError(currentId))}if("kohler-warranty-privacy-policy"==currentIdName&&(0==document.getElementById("kohler-warranty-privacy-policy").checked?(isValid=!1,showError("#hk-privacy-label",privacyErrorMessage)):(isValid=!0,removeError("#hk-privacy-label"))),"koh-bathroom-fixtures"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,bathroomFixtureErrorMessage)):(isValid=!0,removeError(currentId))}if("koh-interest-products"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,interestedProductErrorMessage)):(isValid=!0,removeError(currentId))}});