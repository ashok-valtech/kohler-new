function onAjaxError(customMsg){customMsg.length>0&&$("#failureMessage").html(customMsg),grecaptcha.reset(),$("#koh-contact-form-btn").removeClass("koh-form-btn-loader"),$("#koh-contact-upload-file-name").hide(),$(".koh-upload-wrapper").show(),$("html, body").animate({scrollTop:0},"fast"),$("form").find("input[type=text], input[type=file], textarea, select").val(""),$("#failureMessage").removeClass("hide").fadeIn("fast"),setTimeout(function(){$("#failureMessage").fadeOut(messageFadingTimingLink,function(){$(this).addClass("hide")})},messageTimingLink)}function validateAfterSalesServiceForm(afterSalesServiceLink){var firstName=$("#koh-contact-first-name").val(),lastName=$("#koh-contact-last-name").val(),emailAddress=$("#koh-contact-email-address").val(),mobileNumber=$("#koh-contact-mobile-number").val(),comment=$("#koh-contact-request").val(),thankyouPage=$("#koh-contact-ThankyouPage").val(),homeAddress=$("#koh-contact-address").val(),prodSku=$("#koh-contact-sku").val(),sourcePurchaseSelected=$('input[name="koh-source-of-purchasing"]:checked').val(),sourcePurchaseText=$("#koh-source-purchase-name").val(),sourcePurchaseStr=sourcePurchaseSelected+": "+sourcePurchaseText,recaptchaResponse=grecaptcha.getResponse(),isValid=!0;if(0===sourcePurchaseText.length&&(isValid=!1,showError("#koh-source-purchase-name",sourcePurchaseErrorMessageLink)),(""==firstName||null==firstName)&&(isValid=!1,showError("#koh-contact-first-name",firstNameErrorMessageLink)),(""==lastName||null==lastName)&&(isValid=!1,showError("#koh-contact-last-name",lastNameErrorMessageLink)),(""==emailAddress||null==emailAddress)&&(isValid=!1,showError("#koh-contact-email-address",emailErrorMessageLink)),""==mobileNumber&&(isValid=!1,showError("#koh-contact-mobile-number",mobileErrorMessageLink)),""==homeAddress&&(isValid=!1,showError("#koh-contact-address",homeAddressErrorMessageLink)),""==prodSku&&(isValid=!1,showError("#koh-contact-sku",skuErrorMessageLink)),0===recaptchaResponse.length?(isValid=!1,showError(".g-recaptcha",captchaErrorMessageLink),$(".g-recaptcha > div").css({border:"1px solid #e7102e"})):(removeError("#g-recaptcha"),$(".g-recaptcha > div").css({border:"none"})),1==isValid){var fdata=new FormData;fdata.append("koh-contact-first-name",firstName),fdata.append("koh-contact-last-name",lastName),fdata.append("koh-contact-email-address",emailAddress),fdata.append("koh-contact-mobile-number",mobileNumber),fdata.append("koh-source-of-purchasing",sourcePurchaseStr),fdata.append("koh-contact-address",homeAddress),fdata.append("koh-contact-request",comment),fdata.append("koh-contact-sku",prodSku),fdata.append("koh-contact-google-captcha",recaptchaResponse),$.ajax({url:afterSalesServiceLink,cache:!1,contentType:!1,processData:!1,data:fdata,type:"POST",beforeSend:function(){$("#koh-contact-form-btn").addClass("koh-form-btn-loader")},success:function(data){if("true"==data.success)window.open(thankyouPage,"_self");else{var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}},error:function(error){var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}})}}function recaptchaCallback(){var captchaRes=grecaptcha.getResponse();0!==captchaRes.length&&(removeError(".captcha-container"),$("#g-recaptcha").css("border","none"),$("#g-recaptcha").children("div:first-child").css("border","none"))}var firstNameErrorMessageLink=$("#firstNameErrorMessageLink").val(),lastNameErrorMessageLink=$("#lastNameErrorMessageLink").val(),emailErrorMessageLink=$("#emailErrorMessageLink").val(),mobileErrorMessageLink=$("#mobileErrorMessageLink").val(),captchaErrorMessageLink=$("#captchaErrorMessageLink").val(),emailErrorMessageLink2=$("#emailErrorMessageLink2").val(),mobileErrorMessageLink2=$("#mobileErrorMessageLink2").val(),messageTimingLink=$("#messageTimingLink").val(),messageFadingTimingLink=$("#messageFadingTimingLink").val(),homeAddressErrorMessageLink=$("#homeAddressErrorMessageLink").val(),sourcePurchaseErrorMessageLink=$("#sourcePurchaseErrorMessageLink").val(),skuErrorMessageLink=$("#skuErrorMessage").val(),head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.onload=function(){scaleCaptcha()};var scaleCaptcha=function(){var reCaptchaWidth=304,containerWidth=$(".captcha-container").width(),captchaElements=$(".g-recaptcha");if(reCaptchaWidth>=containerWidth){var scale=.82;captchaElements.css("transform","scale("+scale+")").css("-webkit-transform","scale("+scale+")").css("-ms-transform","scale("+scale+")").css("-o-transform","scale("+scale+")").css("transform-origin","0 0").css("-webkit-transform-origin","0 0").css("-ms-transform-origin","0 0").css("-o-transform-origin","0 0"),$(".captcha-container").height(68)}};script.src="https://www.google.com/recaptcha/api.js",head.appendChild(script);var disableSubmit=function(errorCount){errorCount>0?$("#koh-contact-form-btn").attr("disabled",!0):$("#koh-contact-form-btn").removeAttr("disabled")};$(document).ready(function(){$("#afterSalesServiceForm").submit(function(e){e.preventDefault();var afterSalesServiceLink=$(this).attr("action");validateAfterSalesServiceForm(afterSalesServiceLink)})});var showError=function(ele,errorMessage){$(ele).parent().find(".koh-error").remove(),$(ele).after("<div class='koh-error'>"+errorMessage+"</div>"),$(ele).css({"border-color":"#e7102e"}),$(ele).closest(".form-group").css({"margin-bottom":"6px"}),disableSubmit(1)},removeError=function(ele){$(ele).parent().find(".koh-error").remove(),$(ele).css({"border-color":"#cccccc"}),$(ele).closest(".form-group").css({"margin-bottom":"15px"});var sfmcErrorCount=$(document).find(".koh-error").size();disableSubmit(sfmcErrorCount)},showCheckboxError=function(ele,errorMessage){$(ele).find(".koh-sfmc-error").remove(),$(ele).append("<div class='koh-sfmc-error'>"+errorMessage+"</div>"),disableSubmit(1)},removeCheckboxError=function(ele){$(ele).find(".koh-sfmc-error").remove();var sfmcErrorCount=$(document).find(".koh-sfmc-error").size(),uploadFileError=$(document).find(".koh-file-upload-error").size(),totalErrorCount=sfmcErrorCount+uploadFileError;disableSubmit(totalErrorCount)},validateEmail=function(ele){var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,currentVal=$(ele).val();return 0==reg.test(currentVal)?!1:!0};$("#koh-contact-mobile-number").on("input",function(event){var start=this.selectionStart-1,end=this.selectionEnd-1;$(this).val().match(/[^0-9-+()]/gi)&&($(this).val($(this).val().replace(/[^0-9-+()]/gi,"")),this.setSelectionRange(start,end))}),$(document).on("keyup change","#afterSalesServiceForm input, #afterSalesServiceForm select, #afterSalesServiceForm textarea",function(e){var currentIdName=$(this).attr("id"),currentId="#"+currentIdName;if("koh-contact-request-type"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,requestTypeErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-contact-first-name"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,firstNameErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-contact-last-name"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,lastNameErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-contact-email-address"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,emailErrorMessageLink)):validateEmail(currentId)?(isValid=!0,removeError(currentId)):(isValid=!1,showError(currentId,emailErrorMessageLink2))}if("koh-contact-mobile-number"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,mobileErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-contact-address"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,homeAddressErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-contact-sku"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,skuErrorMessageLink)):(isValid=!0,removeError(currentId))}if("koh-source-purchase-name"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,sourcePurchaseErrorMessageLink)):(isValid=!0,removeError(currentId))}});