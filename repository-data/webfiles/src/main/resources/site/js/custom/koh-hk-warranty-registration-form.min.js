function onAjaxError(customMsg){customMsg.length>0&&$("#failureMessage").html(customMsg),grecaptcha.reset(),$("#koh-contact-form-btn").removeClass("koh-form-btn-loader"),$("#koh-contact-upload-file-name").hide(),$(".koh-upload-wrapper").show(),$("html, body").animate({scrollTop:0},"fast"),$("form").find("input[type=text], input[type=file], textarea, select").val(""),$("#failureMessage").removeClass("hide").fadeIn("fast"),setTimeout(function(){$("#failureMessage").fadeOut(messageFadingTimingLink,function(){$(this).addClass("hide")})},messageTimingLink)}function validateWarrantyForm(contactEmailLink){var salutation=$("#koh-warranty-salutation").val(),email=$("#koh-warranty-email").val(),fullName=$("#koh-warranty-full-name").val(),mobile=$("#koh-warranty-mobile").val(),address=$("#koh-warranty-address").val(),productDeliveryDate=$("#koh-warranty-product-delivery").val(),purchaseDate=$("#koh-warranty-product-purchase").val(),district=$("#koh-warranty-district").val(),privacyPolicy=$("#kohler-warranty-privacy-policy").val(),contactInfo=$("#kohler-contact-info").val(),whereToBuy=$("#koh-warranty-outlet").val();whereToBuy===lastOutletVal&&(whereToBuy=$("#koh-others-checkbox").val());var checkList=document.getElementsByName("koh-warranty-about-kohler"),productTypeCheckList=document.getElementsByName("koh-warranty-product-type"),checkedItemListStr=returnFormatedString(checkList),productTypeItemStr=returnFormatedString(productTypeCheckList),recaptchaResponse=grecaptcha.getResponse(),isValid=!0;0===productTypeItemStr.length&&(isValid=!1,showCheckboxError("#koh-warranty-product-type",productTypeErrorMessage));var inpFile=document.getElementById("koh-contact-upload-file");if(0===inpFile.files.length&&(isValid=!1,showFileUploadError(".koh-contact-upload-note",uploadErrorMessage)),(""==salutation||null==salutation)&&(isValid=!1,showError("#koh-warranty-salutation",salutationErrormessage)),(""==whereToBuy||null==whereToBuy)&&(isValid=!1,showError("#koh-warranty-outlet",dealerErrorMessage)),""==email||null==email)isValid=!1,showError("#koh-warranty-email",emailErrorMessage1Id);else{var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;0==reg.test(email)&&(isValid=!1,showError("#koh-warranty-email",emailErrorMessage2Id))}if((""==fullName||null==fullName)&&(isValid=!1,showError("#koh-warranty-full-name",nameErrorMessageId)),""==mobile&&(isValid=!1,showError("#koh-warranty-mobile",mobileErrorMessageId)),""==address&&(isValid=!1,showError("#koh-warranty-address",addressErrorMessageId)),""==purchaseDate?(isValid=!1,showError("#koh-warranty-product-purchase",purchaseDateErrorMessage1)):0==validatePurchaseDate("#koh-warranty-product-purchase")?(isValid=!1,showError("#koh-warranty-product-purchase",purchaseDateErrorMessage2)):0==isValidDateFormat(purchaseDate)&&(isValid=!1,showError("#koh-warranty-product-purchase",invalidDateErrorMessage)),""==productDeliveryDate?(isValid=!1,showError("#koh-warranty-product-delivery",deliveryErrorMessage1Id)):0==isValidDateFormat(productDeliveryDate)&&(isValid=!1,showError("#koh-warranty-product-delivery",invalidDateErrorMessage)),""==district&&(isValid=!1,showError("#koh-warranty-district",districtErrorMessage)),0==document.getElementById("kohler-warranty-privacy-policy").checked&&(isValid=!1,showError("#kohler-warranty-privacy-policy",privacyErrorMessage)),0===recaptchaResponse.length?(isValid=!1,showError(".g-recaptcha",captchaErrorMessageId),$(".g-recaptcha > div").css({border:"1px solid #e7102e"})):(removeError("#g-recaptcha"),$(".g-recaptcha > div").css({border:"none"})),1==isValid){var fdata=new FormData;fdata.append("koh-warranty-salutation",salutation),fdata.append("koh-warranty-mobile",mobile),fdata.append("koh-warranty-address",address),fdata.append("koh-warranty-full-name",fullName),fdata.append("koh-warranty-email",email),fdata.append("koh-warranty-product-delivery",productDeliveryDate),fdata.append("koh-warranty-district",district),fdata.append("koh-warranty-product-purchase",purchaseDate),fdata.append("koh-warranty-product-type",productTypeItemStr),fdata.append("koh-warranty-outlet",whereToBuy),fdata.append("kohler-warranty-privacy-policy",privacyPolicy),fdata.append("kohler-contact-info",contactInfo),fdata.append("koh-warranty-about-kohler",checkedItemListStr);var attachedFile=document.getElementById("koh-contact-upload-file");attachedFile.files.length>0?fdata.append("file",attachedFile.files[0]):fdata.append("file",""),$.ajax({url:contactEmailLink,cache:!1,contentType:!1,processData:!1,data:fdata,type:"POST",beforeSend:function(){$("#koh-contact-form-btn").addClass("koh-form-btn-loader")},success:function(data){if("true"==data.success)window.open(thankYouPageURL,"_self");else if(data.sfmcAPIError)onAjaxError(data.sfmcAPIError);else if(data.fileExtError)onAjaxError(data.fileExtError);else{var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}},error:function(error){var errorMessage=$("#formErrorMessage").val();onAjaxError(errorMessage)}})}}function checkOthersValue(val){var element=document.getElementById("koh-others-checkbox");val===lastOutletVal?element.style.display="block":element.style.display="none"}function recaptchaCallback(){var captchaRes=grecaptcha.getResponse();0!==captchaRes.length&&(removeError(".captcha-container"),$("#g-recaptcha").css("border","none"),$("#g-recaptcha").children("div:first-child").css("border","none"))}var emailErrorMessage1Id=$("#emailErrorMessage1Id").val(),emailErrorMessage2Id=$("#emailErrorMessage2Id").val(),nameErrorMessageId=$("#nameErrorMessageId").val(),mobileErrorMessageId=$("#mobileErrorMessageId").val(),addressErrorMessageId=$("#addressErrorMessageId").val(),deliveryErrorMessage1Id=$("#deliveryErrorMessage1Id").val(),deliveryErrorMessage2Id=$("#deliveryErrorMessage2Id").val(),purchaseErrorMessageId=$("#purchaseErrorMessageId").val(),captchaErrorMessageId=$("#captchaErrorMessageId").val(),validFileErrorMessage=$("#validFileErrorMessageId").val(),fileSizeErrorMessage=$("#fileSizeErrorMessageId").val(),uploadErrorMessage=$("#uploadErrorMessageId").val(),salutationErrormessage=$("#salutationErrormessageId").val(),itemNoErrorMessage=$("#itemNoErrorMessageId").val(),dealerErrorMessage=$("#dealerErrorMessageId").val(),productTypeErrorMessage=$("#productTypeErrorMessageId").val(),districtErrorMessage=$("#districtErrorMessageId").val(),purchaseDateErrorMessage1=$("#purchaseDateErrorMessage1Id").val(),purchaseDateErrorMessage2=$("#purchaseDateErrorMessage2Id").val(),thankYouPageURL=$("#koh-warranty-thankyouPage").val(),privacyErrorMessage=$("#privacyErrorMessage").val(),invalidDateErrorMessage=$("#invalidDateErrorMessage").val(),messageFadingTimingLink=$("#messageFadingTimingLink").val(),messageTimingLink=$("#messageTimingLink").val(),outletList=$("#outletList").val(),lastOutletVal=outletList.split(",").pop(),fileLengthErrorMessage=$("#fileLengthErrorMessageId").val(),head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.onload=function(){scaleCaptcha()};var scaleCaptcha=function(){var reCaptchaWidth=304,containerWidth=$(".captcha-container").width(),captchaElements=$(".g-recaptcha");if(reCaptchaWidth>=containerWidth){var scale=.82;captchaElements.css("transform","scale("+scale+")").css("-webkit-transform","scale("+scale+")").css("-ms-transform","scale("+scale+")").css("-o-transform","scale("+scale+")").css("transform-origin","0 0").css("-webkit-transform-origin","0 0").css("-ms-transform-origin","0 0").css("-o-transform-origin","0 0"),$(".captcha-container").height(68)}};script.src="https://www.google.com/recaptcha/api.js",head.appendChild(script);var disableSubmit=function(errorCount){errorCount>0?$("#koh-contact-form-btn").attr("disabled",!0):$("#koh-contact-form-btn").removeAttr("disabled")},isValidDateFormat=function(dateString){var dateFormat=/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/;return dateFormat.test(dateString)};$("#koh-contact-upload-file").on("change",function(e){var ext=$(this).val().split(".").pop().toLowerCase(),fileName=e.target.files[0].name,fileSize=e.target.files[0].size;-1==$.inArray(ext,["pdf","jpg"])?($(".koh-contact-upload-note").next(".koh-file-upload-error").remove(),$("#koh-contact-upload-file-name").hide(),$(".koh-upload-wrapper").show(),$(".koh-contact-upload-note").after("<div class='koh-file-upload-error'>"+validFileErrorMessage+"</div>"),$(".koh-upload-wrapper").css("border","1px solid rgb(231, 16, 46)"),disableSubmit(1)):fileSize>4194304?($(".koh-contact-upload-note").next(".koh-file-upload-error").remove(),$("#koh-contact-upload-file-name").hide(),$(".koh-upload-wrapper").show(),$(".koh-contact-upload-note").after("<div class='koh-file-upload-error'>"+fileSizeErrorMessage+"</div>"),$(".koh-upload-wrapper").css("border","1px solid rgb(231, 16, 46)"),disableSubmit(1)):fileName.length>84?($(".koh-contact-upload-note").next(".koh-file-upload-error").remove(),$("#koh-contact-upload-file-name").hide(),$(".koh-upload-wrapper").show(),$(".koh-contact-upload-note").after("<div class='koh-file-upload-error'>"+fileLengthErrorMessage+"</div>"),$(".koh-upload-wrapper").css("border","1px solid rgb(231, 16, 46)"),disableSubmit(1)):($(".koh-upload-wrapper").hide(),$(".koh-contact-upload-note").next(".koh-file-upload-error").remove(),$("#koh-contact-upload-file-name").text(fileName).show(),$(".koh-upload-wrapper").css("border","none"),removeError("#koh-contact-upload-file"))}),$("#koh-contact-upload-file-name").on("click",function(){$("#koh-contact-upload-file").trigger("click")}),$(document).ready(function(){$("#hkWarrantyRegistratationForm").submit(function(e){e.preventDefault();var contactEmailLink=$(this).attr("action");validateWarrantyForm(contactEmailLink)})});var returnFormatedString=function(initalArray,delimiter){for(var checkedValue=[],i=0;i<initalArray.length;i++)initalArray[i].checked&&initalArray[i].value&&checkedValue.push(initalArray[i].value);var checkedItemListStr=delimiter?checkedValue.join(delimiter):checkedValue.join();return checkedItemListStr},showError=function(ele,errorMessage){$(ele).parent().find(".koh-sfmc-error").remove(),$(ele).after("<div class='koh-sfmc-error'>"+errorMessage+"</div>"),$(ele).css({"border-color":"#e7102e"}),$(ele).closest(".form-group").css({"margin-bottom":"6px"}),disableSubmit(1)},showCheckboxError=function(ele,errorMessage){$(ele).find(".koh-sfmc-error").remove(),$(ele).append("<div class='koh-sfmc-error'>"+errorMessage+"</div>"),disableSubmit(1)},removeCheckboxError=function(ele){$(ele).find(".koh-sfmc-error").remove();var sfmcErrorCount=$(document).find(".koh-sfmc-error").size(),uploadFileError=$(document).find(".koh-file-upload-error").size(),totalErrorCount=sfmcErrorCount+uploadFileError;disableSubmit(totalErrorCount)},showFileUploadError=function(ele,errorMessage){$(ele).parent().find(".koh-file-upload-error").remove(),$(ele).after("<div class='koh-file-upload-error'>"+errorMessage+"</div>"),$(ele).css({"border-color":"#e7102e"}),$(ele).closest(".form-group").css({"margin-bottom":"6px"})},removeError=function(ele){$(ele).parent().find(".koh-sfmc-error").remove(),$(ele).css({"border-color":"#cccccc"}),$(ele).closest(".form-group").css({"margin-bottom":"15px"});var sfmcErrorCount=$(document).find(".koh-sfmc-error").size(),uploadFileError=$(document).find(".koh-file-upload-error").size(),totalErrorCount=sfmcErrorCount+uploadFileError;disableSubmit(totalErrorCount)},validateEmail=function(ele){var reg=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,currentVal=$(ele).val();return 0==reg.test(currentVal)?!1:!0},validatePurchaseDate=function(ele){var inputDateVal=$("#koh-warranty-product-purchase").val(),today=new Date,dd=today.getDate(),mm=today.getMonth()+1,yyyy=today.getFullYear();return 10>dd&&(dd="0"+dd),10>mm&&(mm="0"+mm),today=yyyy+"-"+mm+"-"+dd,inputDateVal>today?!1:!0};$("#koh-warranty-mobile").on("input",function(event){var start=this.selectionStart-1,end=this.selectionEnd-1;$(this).val().match(/[^0-9-+()]/gi)&&($(this).val($(this).val().replace(/[^0-9-+()]/gi,"")),this.setSelectionRange(start,end))}),$(function(){$("body").on("keydown","#koh-warranty-salutation",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$(function(){$("body").on("keydown","#koh-warranty-full-name",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$(function(){$("body").on("keydown","#koh-warranty-address",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$(function(){$("body").on("keydown","#koh-others-checkbox",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$(function(){$("body").on("keydown","#koh-warranty-product-sku",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$(function(){$("body").on("keydown","#koh-warranty-suggestions",function(e){return 32===e.which&&0===e.target.selectionStart?!1:void 0})}),$("#koh-warranty-product-type").on("click",function(){var productTypeCheckList=document.getElementsByName("koh-warranty-product-type"),productTypeItemStr=returnFormatedString(productTypeCheckList);productTypeItemStr.length>0?removeCheckboxError("#koh-warranty-product-type"):showCheckboxError("#koh-warranty-product-type",productTypeErrorMessage)}),$(document).on("keyup change","#hkWarrantyRegistratationForm input, #hkWarrantyRegistratationForm select, #hkWarrantyRegistratationForm textarea",function(e){var currentIdName=$(this).attr("id"),currentId="#"+currentIdName;if("koh-warranty-salutation"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,salutationErrormessage)):(isValid=!0,removeError(currentId))}if("koh-warranty-email"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,emailErrorMessage1Id)):validateEmail(currentId)?(isValid=!0,removeError(currentId)):(isValid=!1,showError(currentId,emailErrorMessage2Id))}if("koh-warranty-product-type"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showCheckboxError(currentId,productTypeErrorMessage)):(isValid=!0,removeCheckboxError(currentId))}if("koh-warranty-outlet"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,dealerErrorMessage)):(isValid=!0,removeError(currentId))}if("koh-warranty-full-name"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,nameErrorMessageId)):(isValid=!0,removeError(currentId))}if("koh-warranty-product-sku"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,itemNoErrorMessage)):(isValid=!0,removeError(currentId))}if("koh-warranty-mobile"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,mobileErrorMessageId)):(isValid=!0,removeError(currentId))}if("koh-warranty-address"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,addressErrorMessageId)):(isValid=!0,removeError(currentId))}if("koh-warranty-product-purchase"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,purchaseDateErrorMessage1)):validatePurchaseDate(currentId)?isValidDateFormat(currentVal)?(isValid=!0,removeError(currentId)):(isValid=!1,showError(currentId,invalidDateErrorMessage)):(isValid=!1,showError(currentId,purchaseDateErrorMessage2))}if("koh-warranty-product-delivery"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,deliveryErrorMessage1Id)):0==isValidDateFormat(currentVal)?(isValid=!1,showError("#koh-warranty-product-delivery",invalidDateErrorMessage)):(isValid=!0,removeError(currentId))}if("koh-warranty-district"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,"Please enter district")):(isValid=!0,removeError(currentId))}if("koh-warranty-choose"==currentIdName){var currentVal=$(this).val();""==currentVal?(isValid=!1,showError(currentId,purchaseErrorMessageId)):(isValid=!0,removeError(currentId))}"kohler-warranty-privacy-policy"==currentIdName&&(0==document.getElementById("kohler-warranty-privacy-policy").checked?(isValid=!1,showError("#kohler-warranty-privacy-policy",privacyErrorMessage)):(isValid=!0,removeError("#kohler-warranty-privacy-policy")))});