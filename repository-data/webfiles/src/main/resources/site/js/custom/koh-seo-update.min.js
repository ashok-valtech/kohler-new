/*
 * Copyright Â© 2000-2017 Kohler Company. All Rights Reserved.
 */
"use strict";var axKOH=axKOH||{};axKOH.main=axKOH.main||{},axKOH.main.seoUpdate=function(){var componentClass="c-koh-seo-page",titleErrorMessage2="",descErrorMessage="",canonicalURLErrorMessage="",seoTitleErrorMessage="",seoTitleCharValue="",seoDescCharValue="",seoCanonicalURLCharValue="",initseoUpdate=function($components){if($components){var availableFiltersClass=".koh-seo-available-filters",$availableFilters=$components.find(availableFiltersClass);$availableFilters&&$availableFilters.find(".name").each(function(e){$(this).click({target:$components},function(e){e.preventDefault(),removeError("#seo-title"),removeError("#seo-description"),removeError("#canonicalUrl"),$components=e.data.target,$components.find(".name").each(function(){$(this).hasClass("active")&&$(this).removeClass("active")}),$(this).addClass("active");var updatedDocument=$components.find("#updatedDocument");updatedDocument.length>0?(""==updatedDocument.val()&&($("#successMessage").remove(),$("#errorMessage").remove()),updatedDocument.val("")):($("#successMessage").remove(),$("#errorMessage").remove());var $components=e.data.target,category="",prop=$(this).data("prop"),seoTitle=$(this).data("seotitle"),seoDesc=$(this).data("seodesc"),noIndex=$(this).data("noindex"),noFollow=$(this).data("nofollow"),canonicalUrl=$(this).data("canonicalurl");"undefined"!=typeof $(this).data("category")&&(category=$(this).data("category")),1==noIndex?$components.find("#noIndex").prop("checked",!0):$components.find("#noIndex").prop("checked",!1),1==noFollow?$components.find("#noFollow").prop("checked",!0):$components.find("#noFollow").prop("checked",!1),$components.find("#pageDocument").val(prop),$components.find("#seo-title").val(seoTitle),$components.find("#seo-description").val(seoDesc),$components.find("#canonicalUrl").val(canonicalUrl),""!==category&&$components.find("#category").val(category),$components.find(".koh-active-seo").each(function(){$(this).hasClass("active")&&$(this).removeClass("active")}),$(this).find(".koh-active-seo").addClass("active");var $siteMapItem=$components.find("#siteMapItem");if($siteMapItem){var $sitemap=$siteMapItem.val(),$visitAn=$components.find(".visit-an");if($visitAn){var $visitAnTitle=$visitAn.attr("title");$visitAnTitle.indexOf($sitemap)>1&&($visitAnTitle=$visitAnTitle.substring(0,$visitAnTitle.indexOf($sitemap)),$visitAnTitle+=$sitemap,""!=prop&&($visitAnTitle=$visitAnTitle+"/"+prop+".html",$visitAn.attr("title",$visitAnTitle)))}}})}),titleErrorMessage2=$components.find("#titleErrorMessage2Id").val(),descErrorMessage=$components.find("#descErrorMessageId").val(),canonicalURLErrorMessage=$components.find("#canonicalURLErrorMessageId").val(),seoTitleErrorMessage=$components.find("#seoTitleErrorMessageId").val(),seoTitleCharValue=$components.find("#seoTitleCharValueId").val(),seoDescCharValue=$components.find("#seoDescCharValueId").val(),seoCanonicalURLCharValue=$components.find("#seoCanonicalURLCharValueId").val()}},visitPage=function($components){if($components){var visitPageClass=".visit-an",$visitPages=$components.find(visitPageClass);$visitPages&&$visitPages.each(function(e){$(this).click({target:$components},function(e){e.preventDefault(),$components=e.data.target;var seoPage="",pageDocumentVal="",$siteMapItem=$components.find("#siteMapItem"),$pageDocument=$components.find("#pageDocument");if($siteMapItem&&(seoPage=$siteMapItem.val()),$pageDocument&&(pageDocumentVal=$pageDocument.val()),pageDocumentVal&&""!=pageDocumentVal){var category=$components.find("#category").val();""==category?window.open(seoPage+"/"+pageDocumentVal+".html","_blank"):window.open(seoPage+category,"_blank")}else window.open(seoPage,"_blank")})})}},scrollInResponsive=function($components){var $seoSmScroll=$components.find("#koh-seo-sm-scroll"),$scrollLocation="",$scrollSpeed=0;$seoSmScroll&&($seoSmScroll.is(":visible")?($scrollLocation="#koh-seo-sm-scroll",$scrollSpeed=2e3):($scrollLocation=".koh-page-inner",$scrollSpeed=1e3));var $names=$components.find(".name");$names&&$names.each(function(){$(this).click(function(){$("html, body").animate({scrollTop:$($scrollLocation).offset().top},$scrollSpeed)})});var $parentElement=$components.find(".koh-seo-li");$parentElement&&$parentElement.each(function(){if($(this).hasClass("active")){var $glyphiconMinusElement=$(this).find(".glyphicon-minus");0==$glyphiconMinusElement.length&&$("html, body").animate({scrollTop:$($scrollLocation).offset().top},$scrollSpeed)}})},formSubmit=function($components){var $seoUpdateForm=$components.find("#seoUpdateForm");$seoUpdateForm&&($seoUpdateForm.submit({target:$components},function(e){var $components=e.data.target;0==validateSeoUpdateForm($components)&&e.preventDefault()}),$seoUpdateForm.find("input").each(function(e){$(this).keyup(function(e){var currentVal="",currentIdName=$(this).attr("id"),currentId="#"+currentIdName;if("seo-title"==currentIdName){currentVal=$(this).val();var seoTitleLength=currentVal.length;""==currentVal||0==currentVal.trim().length?showError($(this),seoTitleErrorMessage):seoTitleLength>seoTitleCharValue?showError($(this),titleErrorMessage2):removeError($(this))}if("seo-description"==currentIdName){currentVal=$(this).val();var seoDescLength=currentVal.length;seoDescLength>seoDescCharValue?showError(currentId,descErrorMessage):removeError(currentId)}if("canonicalUrl"==currentIdName){currentVal=$(this).val();var canonicalUrl=currentVal.length;canonicalUrl>seoCanonicalURLCharValue?showError(currentId,canonicalURLErrorMessage):removeError(currentId)}})}))},validateSeoUpdateForm=function($components){var seoTitleValue=$components.find("#seo-title").val(),seoDescValue=$components.find("#seo-description").val(),canonicalUrlValue=$components.find("#canonicalUrl").val(),isValid=!0,seoTitleLength=seoTitleValue.length,seoDescLength=seoDescValue.length,seoCanonicalUrlLength=canonicalUrlValue.length;return""==seoTitleValue||0==seoTitleValue.trim().length?(isValid=!1,showError("#seo-title",seoTitleErrorMessage)):seoTitleLength>seoTitleCharValue&&(isValid=!1,showError("#seo-title",titleErrorMessage2)),seoDescLength>seoDescCharValue&&(isValid=!1,showError("#seo-description",descErrorMessage)),seoCanonicalUrlLength>seoCanonicalURLCharValue&&(isValid=!1,showError("#canonicalUrl",canonicalURLErrorMessage)),isValid},showError=function(ele,errorMessage){$(ele).parent().find(".koh-error").remove(),$(ele).after("<div class='koh-error'>"+errorMessage+"</div>"),$(ele).css({"border-color":"#e7102e"}),$(ele).closest(".form-group").css({"margin-bottom":"6px"})},removeError=function(ele){$(ele).parent().find(".koh-error").remove(),$(ele).css({"border-color":"#cccccc"}),$(ele).closest(".form-group").css({"margin-bottom":"15px"})},setUpdatedDocumentData=function($components){var updatedDocument=$components.find("#updatedDocument");if(updatedDocument){var updatedDocumentVal=updatedDocument.val();if(""!=updatedDocumentVal){var availableFiltersClass=".koh-seo-available-filters",$availableFilters=$components.find(availableFiltersClass);$availableFilters&&$availableFilters.find(".name").each(function(e){var prop=$(this).data("prop");updatedDocumentVal==prop&&$(this).trigger("click")})}}};return{initialize:function(){var $components=$("."+componentClass);initseoUpdate($components),visitPage($components),formSubmit($components),scrollInResponsive($components),setUpdatedDocumentData($components)}}}(),$(function(){$(document).ready(function(){axKOH.main.seoUpdate.initialize()})});