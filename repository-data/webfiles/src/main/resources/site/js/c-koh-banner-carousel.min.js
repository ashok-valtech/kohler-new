/*
 * Copyright Â© 2000-2017 Kohler Company. All Rights Reserved.
 */
var axKOH=axKOH||{},mobileScreenWidth=980,smallScreenWidth=768;axKOH.main=axKOH.main||{},axKOH.main.carouselManager=function(){var initCarousel=function(){var slidesToShow,$components=$(".c-koh-banner-carousel");$components.each(function(componentIndex,element){var isthumbnail=$(element).hasClass("koh-banner-thumbnail-comp"),isHero=$(element).hasClass("v-koh-hero"),isArticle=$(element).hasClass("v-koh-article"),isThumbnailRequired=!1;isthumbnail&&(isThumbnailRequired=!0);var $carousels=$(this).children(".koh-carousel");$carousels.each(function(carouselIndex,ele){var sliderIdName="slider_"+componentIndex,sliderNavIdName="sliderNav_"+componentIndex,$carousel=$(this);$carousel.find(".koh-thumbnail-slide-collection").attr("id",sliderIdName),$carousel.find(".koh-thumbnail-slide-navigation").attr("id",sliderNavIdName);var sliderId="#"+sliderIdName,sliderNavId="#"+sliderNavIdName,$carouselControls=$('<div class="koh-carousel-controls"></div>');$carousel.prepend($carouselControls);var $movePrevious=$('<button class="koh-carousel-control previous"><span class="icon"></span><span class="label">Previous</span></button>'),$moveNext=$('<button class="koh-carousel-control next"><span class="icon"></span><span class="label">Next</span></button>');$carouselControls.append($movePrevious),$carouselControls.append($moveNext);var $slideCollection=$carousel.find(".koh-slide-collection"),slideCount=$slideCollection.find(".koh-banner-slide").length;slidesToShow=6>slideCount?2>slideCount?1:slideCount-1:5;var $firstSlide=$slideCollection.find(".koh-banner-slide").first();$slideCollection.each(function(){initSlides($(this),componentIndex+carouselIndex)});var config={autoplay:!1,autoplaySpeed:5e3,adaptiveHeight:!0,dots:!0,dotsClass:"koh-carousel-indicators",arrows:!0,appendArrows:$carouselControls,appendDots:$carouselControls,prevArrow:$movePrevious,nextArrow:$moveNext,pauseOnHover:!0,pauseOnDotsHover:!0,mobileFirst:!0};if($(window).width()<smallScreenWidth){var mobileConfig={draggable:!0,fade:!0,speed:900,infinite:!0,cssEase:"cubic-bezier(0.7, 0, 0.3, 1)",touchThreshold:100};config=Object.assign(config,mobileConfig)}isThumbnailRequired&&(config.asNavFor=sliderNavId,config.fade=!0),isHero&&(config.autoplay=!0),isArticle&&(config.dotsClass="koh-article-carousel-indicators",config.autoplay=!0),$slideCollection.slick(config).on("afterChange",function(event,slick,slideIndex){var $slide=$(slick.$slides.get(slideIndex));repositionControlsHeroBanner($carouselControls,$slide)}),isThumbnailRequired&&$(sliderNavId).slick({asNavFor:sliderId,slidesToShow:Math.min(5,slidesToShow),slidesToScroll:1,arrows:!1,focusOnSelect:!0,centerMode:!0,variableWidth:!0,responsive:[{breakpoint:550,settings:{slidesToShow:Math.min(3,slidesToShow)}}],responsive:[{breakpoint:480,settings:{slidesToShow:Math.min(2,slidesToShow)}}]});var slick=$slideCollection.slick("getSlick");if(slick){var $indicators=slick.$dots;$indicators&&$indicators.on("click","li",function(){var slick=$slideCollection.slick("getSlick");slick&&(slick.slickSetOption("autoplay",!1,!1),slick.autoPlay=$.noop)})}$(window).load(function(){repositionControlsHeroBanner($carouselControls,$firstSlide)}),$(window).resize(function(){waitForFinalEvent(function(){repositionControlsHeroBanner($carouselControls,$firstSlide)},100,"carouselTimer"+componentIndex+carouselIndex)})})})},initShoppingGuideCarousel=function(){var slidesToShow,$components=$(".c-koh-shopping-guide-carousel");$components.each(function(componentIndex,element){var isthumbnail=$(element).hasClass("koh-banner-thumbnail-comp"),isHero=$(element).hasClass("v-koh-hero"),isArticle=$(element).hasClass("v-koh-article"),isThumbnailRequired=!1;isthumbnail&&(isThumbnailRequired=!0);var $carousels=$(this).children(".koh-carousel");$carousels.each(function(carouselIndex,ele){var sliderIdName="slider_"+componentIndex,sliderNavIdName="sliderNav_"+componentIndex,$carousel=$(this);$carousel.find(".koh-thumbnail-slide-collection").attr("id",sliderIdName),$carousel.find(".koh-thumbnail-slide-navigation").attr("id",sliderNavIdName);var sliderId="#"+sliderIdName,sliderNavId="#"+sliderNavIdName,$carouselControls=$('<div class="koh-carousel-controls"></div>');$carousel.prepend($carouselControls);var $movePrevious=$('<button class="koh-carousel-control previous"><span class="icon"></span><span class="label">Previous</span></button>'),$moveNext=$('<button class="koh-carousel-control next"><span class="icon"></span><span class="label">Next</span></button>');$carouselControls.append($movePrevious),$carouselControls.append($moveNext);var $slideCollection=$carousel.find(".koh-slide-collection"),slideCount=$slideCollection.find(".koh-banner-slide").length;slidesToShow=6>slideCount?2>slideCount?1:slideCount-1:5;var $firstSlide=$slideCollection.find(".koh-banner-slide").first();$slideCollection.each(function(){initSlides($(this),componentIndex+carouselIndex)});var config={autoplay:!1,autoplaySpeed:5e3,adaptiveHeight:!0,dots:!0,dotsClass:"koh-carousel-indicators",arrows:!0,appendArrows:$carouselControls,appendDots:$carouselControls,prevArrow:$movePrevious,nextArrow:$moveNext,pauseOnHover:!0,pauseOnDotsHover:!0,mobileFirst:!0};isThumbnailRequired&&(config.autoplay=!0,config.asNavFor=sliderNavId,config.fade=!0),isHero&&(config.autoplay=!0),isArticle&&(config.autoplay=!0,config.autoplaySpeed=3e3),$slideCollection.slick(config).on("afterChange",function(event,slick,slideIndex){var $slide=$(slick.$slides.get(slideIndex));repositionControlsShoppingGuide($carouselControls,$slide)}),isThumbnailRequired&&$(sliderNavId).slick({asNavFor:sliderId,slidesToShow:Math.min(5,slidesToShow),slidesToScroll:1,arrows:!1,focusOnSelect:!0,centerMode:!0,variableWidth:!0,responsive:[{breakpoint:550,settings:{slidesToShow:Math.min(3,slidesToShow)}}],responsive:[{breakpoint:480,settings:{slidesToShow:Math.min(2,slidesToShow)}}]});var slick=$slideCollection.slick("getSlick");if(slick){var $indicators=slick.$dots;$indicators&&$indicators.on("click","li",function(){var slick=$slideCollection.slick("getSlick");slick&&(slick.slickSetOption("autoplay",!1,!1),slick.autoPlay=$.noop)})}$(window).load(function(){repositionControlsShoppingGuide($carouselControls,$firstSlide)}),$(window).resize(function(){waitForFinalEvent(function(){repositionControlsShoppingGuide($carouselControls,$firstSlide)},100,"carouselTimer"+componentIndex+carouselIndex)})})})},repositionControlsHeroBanner=function($controlsContainer,$referenceSlide){var bgWidth="",bgHeight="",$bannerBg=$(window).width()<smallScreenWidth?$referenceSlide.children(".koh-banner-background-mobile").first():$referenceSlide.children(".koh-banner-background").first();$bannerBg?(bgWidth=$bannerBg.width(),bgHeight=$bannerBg.height()):(bgWidth=$referenceSlide.width(),bgHeight=$referenceSlide.height()),$controlsContainer.width(bgWidth).height(bgHeight)},repositionControlsShoppingGuide=function($controlsContainer,$referenceSlide){var bgWidth="",bgHeight="",$bannerBg=$referenceSlide.children(".koh-banner-background").first();$bannerBg?(bgWidth=$bannerBg.width(),bgHeight=$bannerBg.height()):(bgWidth=$referenceSlide.width(),bgHeight=$referenceSlide.height()),$controlsContainer.width(bgWidth).height(bgHeight)},initSlides=function($slideCollection,containerID){var $slides=$slideCollection.children(".koh-banner-slide");$slides.each(function(slideIndex){var $slide=$(this),$overlayBookmark=$slide.find(".koh-overlay-bookmark"),$overlayBookmarkButton=$overlayBookmark.children(".koh-overlay-bookmark-button"),$overlayBookmarkPanel=$overlayBookmark.children(".koh-overlay-bookmark-form");initOverlayPopover($slide,$overlayBookmarkButton,$overlayBookmarkPanel,"bookmarkPopover"+containerID+slideIndex);var $overlayShare=$slide.find(".koh-overlay-social"),$overlayShareButton=$overlayShare.children(".koh-overlay-share-button"),$overlaySharePanel=$overlayShare.children(".koh-overlay-share-menu");if(axKOH&&axKOH.utils&&axKOH.utils.socialShare&&axKOH.utils.socialShare.initAsTooltip($slide,$overlayShareButton,$overlaySharePanel,"sharePopover"+containerID+slideIndex,"koh-carousel-popover"),$slide.hasClass("v-koh-hotspot")){var $hotspotsContainer=$slide.children(".koh-banner-hotspots").first(),$hotspotHeader=$hotspotsContainer.children(".koh-banner-hotspots-header");$hotspotHeader.click({target:$hotspotsContainer,slideCollection:$slideCollection},function(e){toggleOpen(e.data.target);var $slideSet=e.data.slideCollection,$activeSlide=$slideSet.find(".slick-active");$slideSet.children(".slick-list").height($activeSlide.height())});var $hotspots=$hotspotsContainer.children(".koh-banner-hotspots-collection").children(".koh-banner-hotspot");$hotspots.each(function(hotspotIndex){var $hotspot=$(this),$hotspotButton=$hotspot.children(".koh-banner-hotspot-icon"),$hotspotPanel=$hotspot.children(".koh-banner-hotspot-tile"),tipID="hotspotPopover"+containerID+slideIndex+hotspotIndex;initOverlayHotspot($slide,$hotspotButton,$hotspotPanel,tipID),$(window).resize(function(){waitForFinalEvent(function(){initOverlayHotspot($slide,$hotspotButton,$hotspotPanel,tipID)},100,"carouselTimer"+tipID)})})}if($slide.hasClass("v-koh-video")){var $backgroundLink=$slide.children(".koh-banner-background").children("a"),$videoPanel=$slide.children(".koh-banner-video-panel");initAsModal($backgroundLink,$videoPanel,"CarouselVideo"+containerID+slideIndex),$videoPanel.on("opened",function(){var $embeddedVideo=$(this).find("iframe");resizeResponsiveVideo($embeddedVideo)})}var $bannerBackground=$slide.children(".koh-banner-background"),$bannerContent=$slide.children(".koh-banner-content"),url=new URL(window.location.href),path=url.pathname;("/"===path||"/en"===path)&&$(window).width()<smallScreenWidth&&($(".v-koh-hero").find(".koh-banner-title").hide(),$(".v-koh-hero").find(".koh-banner-summary").hide()),$bannerContent.click({background:$bannerBackground},function(e){var $bannerContent=$(this),$bannerBackground=e.data.background;if($bannerContent.offset().top===$bannerBackground.offset().top&&$bannerContent.offset().left===$bannerBackground.offset().left&&$bannerContent.outerWidth()===$bannerBackground.outerWidth()&&$bannerContent.outerHeight()===$bannerBackground.outerHeight()){var $links=$bannerBackground.children("a").first();$links.length&&$links[0].click()}})})},initOverlayPopover=function($slide,$button,$content,tooltipID){$button.qtip({id:tooltipID,content:{text:$content},position:{my:"bottom right",at:"center center",container:$slide,viewport:!0},hide:{when:{event:"mouseout unfocus"},fixed:!0,delay:100},style:{classes:"koh-qtip-popover koh-carousel-popover qtip-light qtip-shadow",tip:!1}})},initOverlayHotspot=function($slide,$button,$content,tooltipID){$(window).width()<mobileScreenWidth?null!==$button.data("qtip")&&$button.qtip("destroy",!0):$button.qtip({id:tooltipID,content:{text:$content.clone()},position:{my:"right top",at:"left top",container:$slide,viewport:!0,adjust:{method:"flip shift"}},hide:{when:{event:"mouseout unfocus"},fixed:!0,delay:100},style:{classes:"koh-qtip-popover koh-carousel-popover qtip-light qtip-shadow",tip:{mimic:"center",offset:50,width:30,height:15}}})},initAsModal=function($button,$panel,remodalID){$panel.data("remodal-id",remodalID),$panel.prepend('<button data-remodal-action="close" class="remodal-close"></button>'),$panel.attr("data-koh-component","c-koh-banner-carousel"),$panel.addClass("c-koh-banner-carousel-modal");var $remodalPanel=$panel.remodal({hashTracking:!0,closeOnCancel:!0,closeOnEscape:!0,closeOnOutsideClick:!0,modifier:""});$button.data("remodal-target",remodalID),$button.click({target:$remodalPanel},function(e){e.preventDefault(),e.stopPropagation();var $target=e.data.target;$target.open()}),$(document).on("closed",$remodalPanel,function(e){e.target&&axKOH.utils.stopVideos(e.target)})},toggleOpen=function($target){$target.hasClass("open")?$target.removeClass("open"):$target.addClass("open")},makeVideoResponsive=function($videoElement){var aspectRatio=$videoElement.data("aspectratio"),maxWidth=$videoElement.data("maxwidth");if(!aspectRatio||!maxWidth){var width=$videoElement.width(),height=$videoElement.height();aspectRatio=height/width,$videoElement.data("aspectratio",aspectRatio),$videoElement.data("maxwidth",width),$videoElement.removeAttr("width"),$videoElement.removeAttr("height")}},resizeResponsiveVideo=function($videoElement){var embedTags="iframe, object, embed",aspectRatio=$videoElement.data("aspectratio"),maxWidth=$videoElement.data("maxwidth");aspectRatio&&maxWidth||(makeVideoResponsive($videoElement),aspectRatio=$videoElement.data("aspectratio"),maxWidth=$videoElement.data("maxwidth"));var $parent=$videoElement.closest(":not("+embedTags+")"),responsiveWidth=320;$parent&&(responsiveWidth=$parent.width()),responsiveWidth=Math.min(responsiveWidth,maxWidth),$videoElement.width(responsiveWidth),$videoElement.height(responsiveWidth*aspectRatio)},timers={},waitForFinalEvent=function(callback,ms,uniqueId){uniqueId||(uniqueId="UNIQUEID"),timers[uniqueId]&&clearTimeout(timers[uniqueId]),timers[uniqueId]=setTimeout(callback,ms)};return{init:function(){initCarousel(),initShoppingGuideCarousel()}}}(),$(function(){$(document).ready(function(){axKOH.main.carouselManager.init()})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImMta29oLWJhbm5lci1jYXJvdXNlbC5qcyJdLCJuYW1lcyI6WyJheEtPSCIsIm1vYmlsZVNjcmVlbldpZHRoIiwic21hbGxTY3JlZW5XaWR0aCIsIm1haW4iLCJjYXJvdXNlbE1hbmFnZXIiLCJpbml0Q2Fyb3VzZWwiLCJzbGlkZXNUb1Nob3ciLCIkY29tcG9uZW50cyIsIiQiLCJlYWNoIiwiY29tcG9uZW50SW5kZXgiLCJlbGVtZW50IiwiaXN0aHVtYm5haWwiLCJoYXNDbGFzcyIsImlzSGVybyIsImlzQXJ0aWNsZSIsImlzVGh1bWJuYWlsUmVxdWlyZWQiLCIkY2Fyb3VzZWxzIiwidGhpcyIsImNoaWxkcmVuIiwiY2Fyb3VzZWxJbmRleCIsImVsZSIsInNsaWRlcklkTmFtZSIsInNsaWRlck5hdklkTmFtZSIsIiRjYXJvdXNlbCIsImZpbmQiLCJhdHRyIiwic2xpZGVySWQiLCJzbGlkZXJOYXZJZCIsIiRjYXJvdXNlbENvbnRyb2xzIiwicHJlcGVuZCIsIiRtb3ZlUHJldmlvdXMiLCIkbW92ZU5leHQiLCJhcHBlbmQiLCIkc2xpZGVDb2xsZWN0aW9uIiwic2xpZGVDb3VudCIsImxlbmd0aCIsIiRmaXJzdFNsaWRlIiwiZmlyc3QiLCJpbml0U2xpZGVzIiwiY29uZmlnIiwiYXV0b3BsYXkiLCJhdXRvcGxheVNwZWVkIiwiYWRhcHRpdmVIZWlnaHQiLCJkb3RzIiwiZG90c0NsYXNzIiwiYXJyb3dzIiwiYXBwZW5kQXJyb3dzIiwiYXBwZW5kRG90cyIsInByZXZBcnJvdyIsIm5leHRBcnJvdyIsInBhdXNlT25Ib3ZlciIsInBhdXNlT25Eb3RzSG92ZXIiLCJtb2JpbGVGaXJzdCIsIndpbmRvdyIsIndpZHRoIiwibW9iaWxlQ29uZmlnIiwiZHJhZ2dhYmxlIiwiZmFkZSIsInNwZWVkIiwiaW5maW5pdGUiLCJjc3NFYXNlIiwidG91Y2hUaHJlc2hvbGQiLCJPYmplY3QiLCJhc3NpZ24iLCJzbGljayIsIm9uIiwiZXZlbnQiLCJzbGlkZUluZGV4IiwiJHNsaWRlIiwiJHNsaWRlcyIsImdldCIsInJlcG9zaXRpb25Db250cm9sc0hlcm9CYW5uZXIiLCJhc05hdkZvciIsIk1hdGgiLCJtaW4iLCJzbGlkZXNUb1Njcm9sbCIsImZvY3VzT25TZWxlY3QiLCJjZW50ZXJNb2RlIiwidmFyaWFibGVXaWR0aCIsInJlc3BvbnNpdmUiLCJicmVha3BvaW50Iiwic2V0dGluZ3MiLCIkaW5kaWNhdG9ycyIsIiRkb3RzIiwic2xpY2tTZXRPcHRpb24iLCJhdXRvUGxheSIsIm5vb3AiLCJsb2FkIiwicmVzaXplIiwid2FpdEZvckZpbmFsRXZlbnQiLCJpbml0U2hvcHBpbmdHdWlkZUNhcm91c2VsIiwicmVwb3NpdGlvbkNvbnRyb2xzU2hvcHBpbmdHdWlkZSIsIiRjb250cm9sc0NvbnRhaW5lciIsIiRyZWZlcmVuY2VTbGlkZSIsImJnV2lkdGgiLCJiZ0hlaWdodCIsIiRiYW5uZXJCZyIsImhlaWdodCIsImNvbnRhaW5lcklEIiwiJG92ZXJsYXlCb29rbWFyayIsIiRvdmVybGF5Qm9va21hcmtCdXR0b24iLCIkb3ZlcmxheUJvb2ttYXJrUGFuZWwiLCJpbml0T3ZlcmxheVBvcG92ZXIiLCIkb3ZlcmxheVNoYXJlIiwiJG92ZXJsYXlTaGFyZUJ1dHRvbiIsIiRvdmVybGF5U2hhcmVQYW5lbCIsInV0aWxzIiwic29jaWFsU2hhcmUiLCJpbml0QXNUb29sdGlwIiwiJGhvdHNwb3RzQ29udGFpbmVyIiwiJGhvdHNwb3RIZWFkZXIiLCJjbGljayIsInRhcmdldCIsInNsaWRlQ29sbGVjdGlvbiIsImUiLCJ0b2dnbGVPcGVuIiwiZGF0YSIsIiRzbGlkZVNldCIsIiRhY3RpdmVTbGlkZSIsIiRob3RzcG90cyIsImhvdHNwb3RJbmRleCIsIiRob3RzcG90IiwiJGhvdHNwb3RCdXR0b24iLCIkaG90c3BvdFBhbmVsIiwidGlwSUQiLCJpbml0T3ZlcmxheUhvdHNwb3QiLCIkYmFja2dyb3VuZExpbmsiLCIkdmlkZW9QYW5lbCIsImluaXRBc01vZGFsIiwiJGVtYmVkZGVkVmlkZW8iLCJyZXNpemVSZXNwb25zaXZlVmlkZW8iLCIkYmFubmVyQmFja2dyb3VuZCIsIiRiYW5uZXJDb250ZW50IiwidXJsIiwiVVJMIiwibG9jYXRpb24iLCJocmVmIiwicGF0aCIsInBhdGhuYW1lIiwiaGlkZSIsImJhY2tncm91bmQiLCJvZmZzZXQiLCJ0b3AiLCJsZWZ0Iiwib3V0ZXJXaWR0aCIsIm91dGVySGVpZ2h0IiwiJGxpbmtzIiwiJGJ1dHRvbiIsIiRjb250ZW50IiwidG9vbHRpcElEIiwicXRpcCIsImlkIiwiY29udGVudCIsInRleHQiLCJwb3NpdGlvbiIsIm15IiwiYXQiLCJjb250YWluZXIiLCJ2aWV3cG9ydCIsIndoZW4iLCJmaXhlZCIsImRlbGF5Iiwic3R5bGUiLCJjbGFzc2VzIiwidGlwIiwiY2xvbmUiLCJhZGp1c3QiLCJtZXRob2QiLCJtaW1pYyIsIiRwYW5lbCIsInJlbW9kYWxJRCIsImFkZENsYXNzIiwiJHJlbW9kYWxQYW5lbCIsInJlbW9kYWwiLCJoYXNoVHJhY2tpbmciLCJjbG9zZU9uQ2FuY2VsIiwiY2xvc2VPbkVzY2FwZSIsImNsb3NlT25PdXRzaWRlQ2xpY2siLCJtb2RpZmllciIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiJHRhcmdldCIsIm9wZW4iLCJkb2N1bWVudCIsInN0b3BWaWRlb3MiLCJyZW1vdmVDbGFzcyIsIm1ha2VWaWRlb1Jlc3BvbnNpdmUiLCIkdmlkZW9FbGVtZW50IiwiYXNwZWN0UmF0aW8iLCJtYXhXaWR0aCIsInJlbW92ZUF0dHIiLCJlbWJlZFRhZ3MiLCIkcGFyZW50IiwiY2xvc2VzdCIsInJlc3BvbnNpdmVXaWR0aCIsInRpbWVycyIsImNhbGxiYWNrIiwibXMiLCJ1bmlxdWVJZCIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJpbml0IiwicmVhZHkiXSwibWFwcGluZ3MiOiI7OztBQUlBLEdBQUlBLE9BQVFBLFVBQ1JDLGtCQUFvQixJQUNwQkMsaUJBQW1CLEdBRXZCRixPQUFNRyxLQUFPSCxNQUFNRyxTQUVuQkgsTUFBTUcs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IiwiZmlsZSI6ImMta29oLWJhbm5lci1jYXJvdXNlbC5taW4uanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IMKpIDIwMDAtMjAxNyBLb2hsZXIgQ29tcGFueS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqL1xuXG52YXIgYXhLT0ggPSBheEtPSCB8fCB7fTtcbnZhciBtb2JpbGVTY3JlZW5XaWR0aCA9IDk4MDtcbnZhciBzbWFsbFNjcmVlbldpZHRoID0gNzY4O1xuXG5heEtPSC5tYWluID0gYXhLT0gubWFpbiB8fCB7fTtcblxuYXhLT0gubWFpbi5jYXJvdXNlbE1hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGluaXRDYXJvdXNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gTG9jYXRlIGFsbCBpbnN0YW5jZXMgb2YgdGhlIGNvbXBvbmVudFxuICAgICAgICB2YXIgJGNvbXBvbmVudHMgPSAkKFwiLmMta29oLWJhbm5lci1jYXJvdXNlbFwiKSwgc2xpZGVzVG9TaG93O1xuXG4gICAgICAgICRjb21wb25lbnRzLmVhY2goZnVuY3Rpb24gKGNvbXBvbmVudEluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgaXN0aHVtYm5haWwgPSAkKGVsZW1lbnQpLmhhc0NsYXNzKCdrb2gtYmFubmVyLXRodW1ibmFpbC1jb21wJyk7XG4gICAgICAgICAgICB2YXIgaXNIZXJvID0gJChlbGVtZW50KS5oYXNDbGFzcygndi1rb2gtaGVybycpO1xuXHRcdFx0dmFyIGlzQXJ0aWNsZSA9ICQoZWxlbWVudCkuaGFzQ2xhc3MoJ3Yta29oLWFydGljbGUnKTtcbiAgICAgICAgICAgIHZhciBpc1RodW1ibmFpbFJlcXVpcmVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoaXN0aHVtYm5haWwpIHtcbiAgICAgICAgICAgICAgICBpc1RodW1ibmFpbFJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblx0XHRcdC8vIHZhciByaWJib25JdGVtQ291bnQgPSAkKFwiI3Byb21vdGlvblJpYmJvbkl0ZW1zXCIpLnZhbCgpO1xuICAgICAgICAgICAgLy8gaWYgKHJpYmJvbkl0ZW1Db3VudCA9PSAwKSB7XG5cdCAgICAgICAgLy8gICAgIGlmICh3aW5kb3cuc2NyZWVuLndpZHRoIDwgMTAyMykge1xuXHQgICAgICAgIC8vICAgICBcdCQoXCIuYy1rb2gtYmFubmVyLWNhcm91c2VsXCIpLmZpcnN0KCkuY3NzKFwibWFyZ2luLXRvcFwiLCBcIjQwcHhcIik7XG5cdCAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIH1lbHNlIHtcbiAgICAgICAgICAgIC8vICAgICBpZiAod2luZG93LnNjcmVlbi53aWR0aCA8IHNtYWxsU2NyZWVuV2lkdGgpIHtcblx0ICAgICAgICAvLyAgICAgXHQkKFwiLmMta29oLWJhbm5lci1jYXJvdXNlbFwiKS5jc3MoXCJtYXJnaW4tdG9wXCIsIFwiNTVweFwiKTtcblx0ICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBtYWluIGNhcm91c2VsIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciAkY2Fyb3VzZWxzID0gJCh0aGlzKS5jaGlsZHJlbihcIi5rb2gtY2Fyb3VzZWxcIik7XG5cbiAgICAgICAgICAgICRjYXJvdXNlbHMuZWFjaChmdW5jdGlvbiAoY2Fyb3VzZWxJbmRleCwgZWxlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVySWROYW1lID0gJ3NsaWRlcl8nICsgY29tcG9uZW50SW5kZXg7XG4gICAgICAgICAgICAgICAgdmFyIHNsaWRlck5hdklkTmFtZSA9ICdzbGlkZXJOYXZfJyArIGNvbXBvbmVudEluZGV4O1xuXG4gICAgICAgICAgICAgICAgdmFyICRjYXJvdXNlbCA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmtvaC10aHVtYm5haWwtc2xpZGUtY29sbGVjdGlvbicpLmF0dHIoJ2lkJywgc2xpZGVySWROYW1lKTtcbiAgICAgICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmtvaC10aHVtYm5haWwtc2xpZGUtbmF2aWdhdGlvbicpLmF0dHIoJ2lkJywgc2xpZGVyTmF2SWROYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBzbGlkZXJJZCA9ICcjJyArIHNsaWRlcklkTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVyTmF2SWQgPSAnIycgKyBzbGlkZXJOYXZJZE5hbWU7XG5cblxuICAgICAgICAgICAgICAgIC8vIEFkZGluZyBhIGRpdiB0byB0aGUgY2Fyb3VzZWwgc28gd2UgY2FuIGdyb3VwIHRoZSBjb250cm9sc1xuICAgICAgICAgICAgICAgIHZhciAkY2Fyb3VzZWxDb250cm9scyA9ICQoJzxkaXYgY2xhc3M9XCJrb2gtY2Fyb3VzZWwtY29udHJvbHNcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgICAgICAkY2Fyb3VzZWwucHJlcGVuZCgkY2Fyb3VzZWxDb250cm9scyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgJG1vdmVQcmV2aW91cyA9ICQoJzxidXR0b24gY2xhc3M9XCJrb2gtY2Fyb3VzZWwtY29udHJvbCBwcmV2aW91c1wiPjxzcGFuIGNsYXNzPVwiaWNvblwiPjwvc3Bhbj48c3BhbiBjbGFzcz1cImxhYmVsXCI+UHJldmlvdXM8L3NwYW4+PC9idXR0b24+Jyk7XG4gICAgICAgICAgICAgICAgdmFyICRtb3ZlTmV4dCA9ICQoJzxidXR0b24gY2xhc3M9XCJrb2gtY2Fyb3VzZWwtY29udHJvbCBuZXh0XCI+PHNwYW4gY2xhc3M9XCJpY29uXCI+PC9zcGFuPjxzcGFuIGNsYXNzPVwibGFiZWxcIj5OZXh0PC9zcGFuPjwvYnV0dG9uPicpO1xuICAgICAgICAgICAgICAgICRjYXJvdXNlbENvbnRyb2xzLmFwcGVuZCgkbW92ZVByZXZpb3VzKTtcbiAgICAgICAgICAgICAgICAkY2Fyb3VzZWxDb250cm9scy5hcHBlbmQoJG1vdmVOZXh0KTtcblxuXG4gICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgdmFyICRzbGlkZUNvbGxlY3Rpb24gPSAkY2Fyb3VzZWwuZmluZChcIi5rb2gtc2xpZGUtY29sbGVjdGlvblwiKTtcbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVDb3VudCA9ICRzbGlkZUNvbGxlY3Rpb24uZmluZChcIi5rb2gtYmFubmVyLXNsaWRlXCIpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAoc2xpZGVDb3VudCA8IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWRlQ291bnQgPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3cgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93ID0gc2xpZGVDb3VudCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3cgPSA1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgJGZpcnN0U2xpZGUgPSAkc2xpZGVDb2xsZWN0aW9uLmZpbmQoXCIua29oLWJhbm5lci1zbGlkZVwiKS5maXJzdCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gRm9yIGVhY2ggc2xpZGUgY29sbGVjdGlvbiwgaW5pdGlhbGl6ZSB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgJHNsaWRlQ29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFNsaWRlcygkKHRoaXMpLCBjb21wb25lbnRJbmRleCArIGNhcm91c2VsSW5kZXgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLCAvLyBuZXZlciBhdXRvcGxheSBvbiBcIm1vYmlsZVwiXG4gICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5U3BlZWQ6IDVlMyxcbiAgICAgICAgICAgICAgICAgICAgYWRhcHRpdmVIZWlnaHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRvdHM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRvdHNDbGFzczogXCJrb2gtY2Fyb3VzZWwtaW5kaWNhdG9yc1wiLFxuICAgICAgICAgICAgICAgICAgICBhcnJvd3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZEFycm93czogJGNhcm91c2VsQ29udHJvbHMsXG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZERvdHM6ICRjYXJvdXNlbENvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgICBwcmV2QXJyb3c6ICRtb3ZlUHJldmlvdXMsXG4gICAgICAgICAgICAgICAgICAgIG5leHRBcnJvdzogJG1vdmVOZXh0LFxuICAgICAgICAgICAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHBhdXNlT25Eb3RzSG92ZXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG1vYmlsZUZpcnN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBjb25maWd1cmF0aW9uIGZvciBtb2JpbGVcbiAgICAgICAgICAgICAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCBzbWFsbFNjcmVlbldpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2JpbGVDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IDkwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZmluaXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzRWFzZTogJ2N1YmljLWJlemllcigwLjcsIDAsIDAuMywgMSknLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG91Y2hUaHJlc2hvbGQ6IDEwMFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gT2JqZWN0LmFzc2lnbihjb25maWcsbW9iaWxlQ29uZmlnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNUaHVtYm5haWxSZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25maWdbJ2FzTmF2Rm9yJ10gPSBzbGlkZXJOYXZJZDtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnWydmYWRlJ10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNIZXJvKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ1snYXV0b3BsYXknXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXHRcdFx0XHRpZihpc0FydGljbGUpe1xuICAgICAgICAgICAgICAgICAgICBjb25maWdbJ2RvdHNDbGFzcyddID0gXCJrb2gtYXJ0aWNsZS1jYXJvdXNlbC1pbmRpY2F0b3JzXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ1snYXV0b3BsYXknXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY2Fyb3VzZWxcbiAgICAgICAgICAgICAgICAkc2xpZGVDb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5zbGljayhjb25maWcpLm9uKCdhZnRlckNoYW5nZScsIGZ1bmN0aW9uIChldmVudCwgc2xpY2ssIHNsaWRlSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkc2xpZGUgPSAkKHNsaWNrLiRzbGlkZXMuZ2V0KHNsaWRlSW5kZXgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9zaXRpb25Db250cm9sc0hlcm9CYW5uZXIoJGNhcm91c2VsQ29udHJvbHMsICRzbGlkZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzVGh1bWJuYWlsUmVxdWlyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgJChzbGlkZXJOYXZJZCkuc2xpY2soe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNOYXZGb3I6IHNsaWRlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiBNYXRoLm1pbig1LCBzbGlkZXNUb1Nob3cpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJvd3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPblNlbGVjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlck1vZGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYWJsZVdpZHRoOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2l2ZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtwb2ludDogNTUwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiBNYXRoLm1pbigzLCBzbGlkZXNUb1Nob3cpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDQ4MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogTWF0aC5taW4oMiwgc2xpZGVzVG9TaG93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgc2xpY2sgPSAkc2xpZGVDb2xsZWN0aW9uLnNsaWNrKCdnZXRTbGljaycpO1xuICAgICAgICAgICAgICAgIGlmIChzbGljaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGluZGljYXRvcnMgPSBzbGljay4kZG90cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRpbmRpY2F0b3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5kaWNhdG9ycy5vbignY2xpY2snLCAnbGknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWNrID0gJHNsaWRlQ29sbGVjdGlvbi5zbGljaygnZ2V0U2xpY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2suc2xpY2tTZXRPcHRpb24oXCJhdXRvcGxheVwiLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljay5hdXRvUGxheSA9ICQubm9vcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEluIG9yZGVyIHRvIG1ha2UgdGhlIGNvbnRyb2xzIGFwcGVhciB3aGVyZSBLb2hsZXIgd2FudHMgdGhlbSBhdCBhbGwgc2NyZWVuIHNpemVzLFxuICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gc2l6ZSB0aGUgY29udHJvbHMgY29udGFpbmVyIHRvIG1hdGNoIHRoZSBiYW5uZXIgYmFja2dyb3VuZCwgYW5kIHRoZW4gd2VcbiAgICAgICAgICAgICAgICAvLyBjYW4gcG9zaXRpb24gdGhlIGNvbnRyb2xzIGFjY29yZGluZ2x5LlxuICAgICAgICAgICAgICAgICQod2luZG93KS5sb2FkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVwb3NpdGlvbkNvbnRyb2xzSGVyb0Jhbm5lcigkY2Fyb3VzZWxDb250cm9scywgJGZpcnN0U2xpZGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB3YWl0Rm9yRmluYWxFdmVudChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvc2l0aW9uQ29udHJvbHNIZXJvQmFubmVyKCRjYXJvdXNlbENvbnRyb2xzLCAkZmlyc3RTbGlkZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCwgXCJjYXJvdXNlbFRpbWVyXCIgKyBjb21wb25lbnRJbmRleCArIGNhcm91c2VsSW5kZXgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTsgLy8gZW5kIGNhcm91c2VsLmVhY2hcbiAgICAgICAgfSk7IC8vIGVuZCBjb21wb25lbnRzLmVhY2hcbiAgICB9O1xuXG4gICAgXG4gICAgLy8gc2hvcHBpbmcgZ3VpZGUgY2Fyb3VzZWwgY29tcG9uZW50cyBzdGFydHMgZnJvbSBoZXJlXG4gICAgXG4gICAgdmFyIGluaXRTaG9wcGluZ0d1aWRlQ2Fyb3VzZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIExvY2F0ZSBhbGwgaW5zdGFuY2VzIG9mIHRoZSBjb21wb25lbnRcbiAgICAgICAgdmFyICRjb21wb25lbnRzID0gJChcIi5jLWtvaC1zaG9wcGluZy1ndWlkZS1jYXJvdXNlbFwiKSwgc2xpZGVzVG9TaG93O1xuXG4gICAgICAgICRjb21wb25lbnRzLmVhY2goZnVuY3Rpb24gKGNvbXBvbmVudEluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgaXN0aHVtYm5haWwgPSAkKGVsZW1lbnQpLmhhc0NsYXNzKCdrb2gtYmFubmVyLXRodW1ibmFpbC1jb21wJyk7XG4gICAgICAgICAgICB2YXIgaXNIZXJvID0gJChlbGVtZW50KS5oYXNDbGFzcygndi1rb2gtaGVybycpO1xuXHRcdFx0dmFyIGlzQXJ0aWNsZSA9ICQoZWxlbWVudCkuaGFzQ2xhc3MoJ3Yta29oLWFydGljbGUnKTtcbiAgICAgICAgICAgIHZhciBpc1RodW1ibmFpbFJlcXVpcmVkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoaXN0aHVtYm5haWwpIHtcbiAgICAgICAgICAgICAgICBpc1RodW1ibmFpbFJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHZhciByaWJib25JdGVtQ291bnQgPSAkKFwiI3Byb21vdGlvblJpYmJvbkl0ZW1zXCIpLnZhbCgpO1xuICAgICAgICAgICAgLy8gaWYgKHJpYmJvbkl0ZW1Db3VudCA9PSAwKSB7XG5cdCAgICAgICAgLy8gICAgIGlmICh3aW5kb3cuc2NyZWVuLndpZHRoIDwgMTAyMykge1xuXHQgICAgICAgIC8vICAgICBcdCQoXCIuYy1rb2gtc2hvcHBpbmctZ3VpZGUtY2Fyb3VzZWxcIikuZmlyc3QoKS5jc3MoXCJtYXJnaW4tdG9wXCIsIFwiNDBweFwiKTtcblx0ICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gfWVsc2Uge1xuICAgICAgICAgICAgLy8gICAgIGlmICh3aW5kb3cuc2NyZWVuLndpZHRoIDwgMTAyMykge1xuXHQgICAgICAgIC8vICAgICBcdCQoXCIuYy1rb2gtc2hvcHBpbmctZ3VpZGUtY2Fyb3VzZWxcIikuY3NzKFwibWFyZ2luLXRvcFwiLCBcIjU1cHhcIik7XG5cdCAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgLy8gRmluZCB0aGUgbWFpbiBjYXJvdXNlbCBlbGVtZW50XG4gICAgICAgICAgICB2YXIgJGNhcm91c2VscyA9ICQodGhpcykuY2hpbGRyZW4oXCIua29oLWNhcm91c2VsXCIpO1xuXG4gICAgICAgICAgICAkY2Fyb3VzZWxzLmVhY2goZnVuY3Rpb24gKGNhcm91c2VsSW5kZXgsIGVsZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNsaWRlcklkTmFtZSA9ICdzbGlkZXJfJyArIGNvbXBvbmVudEluZGV4O1xuICAgICAgICAgICAgICAgIHZhciBzbGlkZXJOYXZJZE5hbWUgPSAnc2xpZGVyTmF2XycgKyBjb21wb25lbnRJbmRleDtcblxuICAgICAgICAgICAgICAgIHZhciAkY2Fyb3VzZWwgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5rb2gtdGh1bWJuYWlsLXNsaWRlLWNvbGxlY3Rpb24nKS5hdHRyKCdpZCcsIHNsaWRlcklkTmFtZSk7XG4gICAgICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5rb2gtdGh1bWJuYWlsLXNsaWRlLW5hdmlnYXRpb24nKS5hdHRyKCdpZCcsIHNsaWRlck5hdklkTmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVySWQgPSAnIycgKyBzbGlkZXJJZE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIHNsaWRlck5hdklkID0gJyMnICsgc2xpZGVyTmF2SWROYW1lO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkaW5nIGEgZGl2IHRvIHRoZSBjYXJvdXNlbCBzbyB3ZSBjYW4gZ3JvdXAgdGhlIGNvbnRyb2xzXG4gICAgICAgICAgICAgICAgdmFyICRjYXJvdXNlbENvbnRyb2xzID0gJCgnPGRpdiBjbGFzcz1cImtvaC1jYXJvdXNlbC1jb250cm9sc1wiPjwvZGl2PicpO1xuICAgICAgICAgICAgICAgICRjYXJvdXNlbC5wcmVwZW5kKCRjYXJvdXNlbENvbnRyb2xzKTtcblxuICAgICAgICAgICAgICAgIHZhciAkbW92ZVByZXZpb3VzID0gJCgnPGJ1dHRvbiBjbGFzcz1cImtvaC1jYXJvdXNlbC1jb250cm9sIHByZXZpb3VzXCI+PHNwYW4gY2xhc3M9XCJpY29uXCI+PC9zcGFuPjxzcGFuIGNsYXNzPVwibGFiZWxcIj5QcmV2aW91czwvc3Bhbj48L2J1dHRvbj4nKTtcbiAgICAgICAgICAgICAgICB2YXIgJG1vdmVOZXh0ID0gJCgnPGJ1dHRvbiBjbGFzcz1cImtvaC1jYXJvdXNlbC1jb250cm9sIG5leHRcIj48c3BhbiBjbGFzcz1cImljb25cIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJsYWJlbFwiPk5leHQ8L3NwYW4+PC9idXR0b24+Jyk7XG4gICAgICAgICAgICAgICAgJGNhcm91c2VsQ29udHJvbHMuYXBwZW5kKCRtb3ZlUHJldmlvdXMpO1xuICAgICAgICAgICAgICAgICRjYXJvdXNlbENvbnRyb2xzLmFwcGVuZCgkbW92ZU5leHQpO1xuXG4gICAgICAgICAgICAgICAgLy8gRmluZCB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgdmFyICRzbGlkZUNvbGxlY3Rpb24gPSAkY2Fyb3VzZWwuZmluZChcIi5rb2gtc2xpZGUtY29sbGVjdGlvblwiKTtcbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVDb3VudCA9ICRzbGlkZUNvbGxlY3Rpb24uZmluZChcIi5rb2gtYmFubmVyLXNsaWRlXCIpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAoc2xpZGVDb3VudCA8IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNsaWRlQ291bnQgPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3cgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93ID0gc2xpZGVDb3VudCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3cgPSA1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgJGZpcnN0U2xpZGUgPSAkc2xpZGVDb2xsZWN0aW9uLmZpbmQoXCIua29oLWJhbm5lci1zbGlkZVwiKS5maXJzdCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gRm9yIGVhY2ggc2xpZGUgY29sbGVjdGlvbiwgaW5pdGlhbGl6ZSB0aGUgc2xpZGVzXG4gICAgICAgICAgICAgICAgJHNsaWRlQ29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFNsaWRlcygkKHRoaXMpLCBjb21wb25lbnRJbmRleCArIGNhcm91c2VsSW5kZXgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLCAvLyBuZXZlciBhdXRvcGxheSBvbiBcIm1vYmlsZVwiXG4gICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5U3BlZWQ6IDVlMyxcbiAgICAgICAgICAgICAgICAgICAgYWRhcHRpdmVIZWlnaHQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRvdHM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRvdHNDbGFzczogXCJrb2gtY2Fyb3VzZWwtaW5kaWNhdG9yc1wiLFxuICAgICAgICAgICAgICAgICAgICBhcnJvd3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZEFycm93czogJGNhcm91c2VsQ29udHJvbHMsXG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZERvdHM6ICRjYXJvdXNlbENvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgICBwcmV2QXJyb3c6ICRtb3ZlUHJldmlvdXMsXG4gICAgICAgICAgICAgICAgICAgIG5leHRBcnJvdzogJG1vdmVOZXh0LFxuICAgICAgICAgICAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHBhdXNlT25Eb3RzSG92ZXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIG1vYmlsZUZpcnN0OiB0cnVlXG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgaWYgKGlzVGh1bWJuYWlsUmVxdWlyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnWydhdXRvcGxheSddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnWydhc05hdkZvciddID0gc2xpZGVyTmF2SWQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ1snZmFkZSddID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzSGVybykge1xuICAgICAgICAgICAgICAgICAgICBjb25maWdbJ2F1dG9wbGF5J10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblx0XHRcdFx0aWYoaXNBcnRpY2xlKXtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnWydhdXRvcGxheSddID0gdHJ1ZTtcblx0XHRcdFx0XHRjb25maWdbJ2F1dG9wbGF5U3BlZWQnXSA9IDNlMztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBjYXJvdXNlbFxuICAgICAgICAgICAgICAgICRzbGlkZUNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLnNsaWNrKGNvbmZpZykub24oJ2FmdGVyQ2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50LCBzbGljaywgc2xpZGVJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRzbGlkZSA9ICQoc2xpY2suJHNsaWRlcy5nZXQoc2xpZGVJbmRleCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3NpdGlvbkNvbnRyb2xzU2hvcHBpbmdHdWlkZSgkY2Fyb3VzZWxDb250cm9scywgJHNsaWRlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNUaHVtYm5haWxSZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChzbGlkZXJOYXZJZCkuc2xpY2soe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTmF2Rm9yOiBzbGlkZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IE1hdGgubWluKDUsIHNsaWRlc1RvU2hvdyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyb3dzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uU2VsZWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlck1vZGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGVXaWR0aDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDU1MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiBNYXRoLm1pbigzLCBzbGlkZXNUb1Nob3cpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zaXZlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDQ4MCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiBNYXRoLm1pbigyLCBzbGlkZXNUb1Nob3cpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9ICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgc2xpY2sgPSAkc2xpZGVDb2xsZWN0aW9uLnNsaWNrKCdnZXRTbGljaycpO1xuICAgICAgICAgICAgICAgIGlmIChzbGljaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGluZGljYXRvcnMgPSBzbGljay4kZG90cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRpbmRpY2F0b3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkaW5kaWNhdG9ycy5vbignY2xpY2snLCAnbGknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWNrID0gJHNsaWRlQ29sbGVjdGlvbi5zbGljaygnZ2V0U2xpY2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2xpY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2suc2xpY2tTZXRPcHRpb24oXCJhdXRvcGxheVwiLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGljay5hdXRvUGxheSA9ICQubm9vcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBJbiBvcmRlciB0byBtYWtlIHRoZSBjb250cm9scyBhcHBlYXIgd2hlcmUgS29obGVyIHdhbnRzIHRoZW0gYXQgYWxsIHNjcmVlbiBzaXplcyxcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHNpemUgdGhlIGNvbnRyb2xzIGNvbnRhaW5lciB0byBtYXRjaCB0aGUgYmFubmVyIGJhY2tncm91bmQsIGFuZCB0aGVuIHdlXG4gICAgICAgICAgICAgICAgLy8gY2FuIHBvc2l0aW9uIHRoZSBjb250cm9scyBhY2NvcmRpbmdseS5cbiAgICAgICAgICAgICAgICAkKHdpbmRvdykubG9hZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcG9zaXRpb25Db250cm9sc1Nob3BwaW5nR3VpZGUoJGNhcm91c2VsQ29udHJvbHMsICRmaXJzdFNsaWRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgd2FpdEZvckZpbmFsRXZlbnQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3NpdGlvbkNvbnRyb2xzU2hvcHBpbmdHdWlkZSgkY2Fyb3VzZWxDb250cm9scywgJGZpcnN0U2xpZGUpO1xuICAgICAgICAgICAgICAgICAgICB9LCAxMDAsIFwiY2Fyb3VzZWxUaW1lclwiICsgY29tcG9uZW50SW5kZXggKyBjYXJvdXNlbEluZGV4KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7IC8vIGVuZCBjYXJvdXNlbC5lYWNoXG4gICAgICAgIH0pOyAvLyBlbmQgY29tcG9uZW50cy5lYWNoXG4gICAgfTtcblxuICAgIHZhciByZXBvc2l0aW9uQ29udHJvbHNIZXJvQmFubmVyID0gZnVuY3Rpb24gKCRjb250cm9sc0NvbnRhaW5lciwgJHJlZmVyZW5jZVNsaWRlKSB7XG4gICAgICAgIHZhciBiZ1dpZHRoID0gXCJcIjtcbiAgICAgICAgdmFyIGJnSGVpZ2h0ID0gXCJcIjtcblxuICAgICAgICB2YXIgJGJhbm5lckJnID0gJCh3aW5kb3cpLndpZHRoKCkgPCBzbWFsbFNjcmVlbldpZHRoID8gJHJlZmVyZW5jZVNsaWRlLmNoaWxkcmVuKFwiLmtvaC1iYW5uZXItYmFja2dyb3VuZC1tb2JpbGVcIikuZmlyc3QoKSAgOiAkcmVmZXJlbmNlU2xpZGUuY2hpbGRyZW4oXCIua29oLWJhbm5lci1iYWNrZ3JvdW5kXCIpLmZpcnN0KCk7XG5cbiAgICAgICAgaWYgKCRiYW5uZXJCZykge1xuICAgICAgICAgICAgYmdXaWR0aCA9ICRiYW5uZXJCZy53aWR0aCgpO1xuICAgICAgICAgICAgYmdIZWlnaHQgPSAkYmFubmVyQmcuaGVpZ2h0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiZ1dpZHRoID0gJHJlZmVyZW5jZVNsaWRlLndpZHRoKCk7XG4gICAgICAgICAgICBiZ0hlaWdodCA9ICRyZWZlcmVuY2VTbGlkZS5oZWlnaHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgICRjb250cm9sc0NvbnRhaW5lci53aWR0aChiZ1dpZHRoKS5oZWlnaHQoYmdIZWlnaHQpO1xuICAgIH07XG5cbiAgICB2YXIgcmVwb3NpdGlvbkNvbnRyb2xzU2hvcHBpbmdHdWlkZSA9IGZ1bmN0aW9uICgkY29udHJvbHNDb250YWluZXIsICRyZWZlcmVuY2VTbGlkZSkge1xuICAgICAgICB2YXIgYmdXaWR0aCA9IFwiXCI7XG4gICAgICAgIHZhciBiZ0hlaWdodCA9IFwiXCI7XG5cbiAgICAgICAgdmFyICRiYW5uZXJCZyA9ICRyZWZlcmVuY2VTbGlkZS5jaGlsZHJlbihcIi5rb2gtYmFubmVyLWJhY2tncm91bmRcIikuZmlyc3QoKTtcblxuICAgICAgICBpZiAoJGJhbm5lckJnKSB7XG4gICAgICAgICAgICBiZ1dpZHRoID0gJGJhbm5lckJnLndpZHRoKCk7XG4gICAgICAgICAgICBiZ0hlaWdodCA9ICRiYW5uZXJCZy5oZWlnaHQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJnV2lkdGggPSAkcmVmZXJlbmNlU2xpZGUud2lkdGgoKTtcbiAgICAgICAgICAgIGJnSGVpZ2h0ID0gJHJlZmVyZW5jZVNsaWRlLmhlaWdodCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgJGNvbnRyb2xzQ29udGFpbmVyLndpZHRoKGJnV2lkdGgpLmhlaWdodChiZ0hlaWdodCk7XG4gICAgfTtcblxuICAgIHZhciBpbml0U2xpZGVzID0gZnVuY3Rpb24gKCRzbGlkZUNvbGxlY3Rpb24sIGNvbnRhaW5lcklEKSB7XG4gICAgICAgIC8vIExvY2F0ZSBhbGwgaW5zdGFuY2VzIG9mIHRoZSBGb290ZXIgTmF2IGNvbXBvbmVudFxuICAgICAgICB2YXIgJHNsaWRlcyA9ICRzbGlkZUNvbGxlY3Rpb24uY2hpbGRyZW4oXCIua29oLWJhbm5lci1zbGlkZVwiKTtcblxuICAgICAgICAkc2xpZGVzLmVhY2goZnVuY3Rpb24gKHNsaWRlSW5kZXgpIHtcbiAgICAgICAgICAgIHZhciAkc2xpZGUgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAvLyBGb3Igc2xpZGVzIHdpdGggYW4gb3ZlcmxheSwgYWRkIGNsaWNrIGV2ZW50cyBmb3IgYm9va21hcmsgYW5kIHNoYXJlIGJ1dHRvbnNcbiAgICAgICAgICAgIHZhciAkb3ZlcmxheUJvb2ttYXJrID0gJHNsaWRlLmZpbmQoXCIua29oLW92ZXJsYXktYm9va21hcmtcIik7XG4gICAgICAgICAgICB2YXIgJG92ZXJsYXlCb29rbWFya0J1dHRvbiA9ICRvdmVybGF5Qm9va21hcmsuY2hpbGRyZW4oXCIua29oLW92ZXJsYXktYm9va21hcmstYnV0dG9uXCIpO1xuICAgICAgICAgICAgdmFyICRvdmVybGF5Qm9va21hcmtQYW5lbCA9ICRvdmVybGF5Qm9va21hcmsuY2hpbGRyZW4oXCIua29oLW92ZXJsYXktYm9va21hcmstZm9ybVwiKTtcbiAgICAgICAgICAgIGluaXRPdmVybGF5UG9wb3Zlcigkc2xpZGUsICRvdmVybGF5Qm9va21hcmtCdXR0b24sICRvdmVybGF5Qm9va21hcmtQYW5lbCwgXCJib29rbWFya1BvcG92ZXJcIiArIGNvbnRhaW5lcklEICsgc2xpZGVJbmRleCk7XG5cbiAgICAgICAgICAgIHZhciAkb3ZlcmxheVNoYXJlID0gJHNsaWRlLmZpbmQoXCIua29oLW92ZXJsYXktc29jaWFsXCIpO1xuICAgICAgICAgICAgdmFyICRvdmVybGF5U2hhcmVCdXR0b24gPSAkb3ZlcmxheVNoYXJlLmNoaWxkcmVuKFwiLmtvaC1vdmVybGF5LXNoYXJlLWJ1dHRvblwiKTtcbiAgICAgICAgICAgIHZhciAkb3ZlcmxheVNoYXJlUGFuZWwgPSAkb3ZlcmxheVNoYXJlLmNoaWxkcmVuKFwiLmtvaC1vdmVybGF5LXNoYXJlLW1lbnVcIik7XG4gICAgICAgICAgICBpZiAoYXhLT0ggJiYgYXhLT0gudXRpbHMgJiYgYXhLT0gudXRpbHMuc29jaWFsU2hhcmUpIHtcbiAgICAgICAgICAgICAgICBheEtPSC51dGlscy5zb2NpYWxTaGFyZS5pbml0QXNUb29sdGlwKCRzbGlkZSwgJG92ZXJsYXlTaGFyZUJ1dHRvbiwgJG92ZXJsYXlTaGFyZVBhbmVsLCBcInNoYXJlUG9wb3ZlclwiICsgY29udGFpbmVySUQgKyBzbGlkZUluZGV4LCBcImtvaC1jYXJvdXNlbC1wb3BvdmVyXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3IgYW55IGhvdHNwb3Qgc2xpZGVzLCBhZGQgY2xpY2sgZXZlbnQgdG8gdmlldyBmZWF0dXJlZCBwcm9kdWN0c1xuICAgICAgICAgICAgaWYgKCRzbGlkZS5oYXNDbGFzcyhcInYta29oLWhvdHNwb3RcIikpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGhvdHNwb3RzQ29udGFpbmVyID0gJHNsaWRlLmNoaWxkcmVuKFwiLmtvaC1iYW5uZXItaG90c3BvdHNcIikuZmlyc3QoKTtcblxuICAgICAgICAgICAgICAgIHZhciAkaG90c3BvdEhlYWRlciA9ICRob3RzcG90c0NvbnRhaW5lci5jaGlsZHJlbihcIi5rb2gtYmFubmVyLWhvdHNwb3RzLWhlYWRlclwiKTtcbiAgICAgICAgICAgICAgICAkaG90c3BvdEhlYWRlci5jbGljayh7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogJGhvdHNwb3RzQ29udGFpbmVyLFxuICAgICAgICAgICAgICAgICAgICBzbGlkZUNvbGxlY3Rpb246ICRzbGlkZUNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVPcGVuKGUuZGF0YS50YXJnZXQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIC5zbGljay1saXN0IHRoYXQgY29udGFpbnMgdGhpcyB0b2dnbGUgYW5kIHJlY2FsY3VsYXRlIHRoZSBzaXplXG4gICAgICAgICAgICAgICAgICAgIHZhciAkc2xpZGVTZXQgPSBlLmRhdGEuc2xpZGVDb2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICB2YXIgJGFjdGl2ZVNsaWRlID0gJHNsaWRlU2V0LmZpbmQoJy5zbGljay1hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgJHNsaWRlU2V0LmNoaWxkcmVuKCcuc2xpY2stbGlzdCcpLmhlaWdodCgkYWN0aXZlU2xpZGUuaGVpZ2h0KCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmFyICRob3RzcG90cyA9ICRob3RzcG90c0NvbnRhaW5lci5jaGlsZHJlbihcIi5rb2gtYmFubmVyLWhvdHNwb3RzLWNvbGxlY3Rpb25cIikuY2hpbGRyZW4oXCIua29oLWJhbm5lci1ob3RzcG90XCIpO1xuICAgICAgICAgICAgICAgICRob3RzcG90cy5lYWNoKGZ1bmN0aW9uIChob3RzcG90SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRob3RzcG90ID0gJCh0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRob3RzcG90QnV0dG9uID0gJGhvdHNwb3QuY2hpbGRyZW4oXCIua29oLWJhbm5lci1ob3RzcG90LWljb25cIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkaG90c3BvdFBhbmVsID0gJGhvdHNwb3QuY2hpbGRyZW4oXCIua29oLWJhbm5lci1ob3RzcG90LXRpbGVcIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aXBJRCA9IFwiaG90c3BvdFBvcG92ZXJcIiArIGNvbnRhaW5lcklEICsgc2xpZGVJbmRleCArIGhvdHNwb3RJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgaW5pdE92ZXJsYXlIb3RzcG90KCRzbGlkZSwgJGhvdHNwb3RCdXR0b24sICRob3RzcG90UGFuZWwsIHRpcElEKTtcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YWl0Rm9yRmluYWxFdmVudChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdE92ZXJsYXlIb3RzcG90KCRzbGlkZSwgJGhvdHNwb3RCdXR0b24sICRob3RzcG90UGFuZWwsIHRpcElEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCwgXCJjYXJvdXNlbFRpbWVyXCIgKyB0aXBJRCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoJHNsaWRlLmhhc0NsYXNzKFwidi1rb2gtdmlkZW9cIikpIHtcbiAgICAgICAgICAgICAgICAvLyBWaWRlbyBzbGlkZXMgZ2V0IGV4dHJhIGhhbmRsaW5nIGZvciB0aGVpciBtb2RhbCB3aW5kb3dcbiAgICAgICAgICAgICAgICB2YXIgJGJhY2tncm91bmRMaW5rID0gJHNsaWRlLmNoaWxkcmVuKFwiLmtvaC1iYW5uZXItYmFja2dyb3VuZFwiKS5jaGlsZHJlbihcImFcIik7XG4gICAgICAgICAgICAgICAgdmFyICR2aWRlb1BhbmVsID0gJHNsaWRlLmNoaWxkcmVuKFwiLmtvaC1iYW5uZXItdmlkZW8tcGFuZWxcIik7XG5cbiAgICAgICAgICAgICAgICBpbml0QXNNb2RhbCgkYmFja2dyb3VuZExpbmssICR2aWRlb1BhbmVsLCBcIkNhcm91c2VsVmlkZW9cIiArIGNvbnRhaW5lcklEICsgc2xpZGVJbmRleCk7XG4gICAgICAgICAgICAgICAgJHZpZGVvUGFuZWwub24oJ29wZW5lZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRlbWJlZGRlZFZpZGVvID0gJCh0aGlzKS5maW5kKFwiaWZyYW1lXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXNpemVSZXNwb25zaXZlVmlkZW8oJGVtYmVkZGVkVmlkZW8pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBdCBkZXNrdG9wIHNpemVzLCB0aGUga29oLWJhbm5lci1jb250ZW50IGNvbXBsZXRlbHkgY292ZXJzIHRoZSBrb2gtYmFubmVyLWJhY2tncm91bmQsIHNvIHRoZSBjbGlja1xuICAgICAgICAgICAgLy8gY2FuJ3QgZ2V0IHRocm91Z2guIFNvIGxldCdzIG1ha2UgdGhlIGNsaWNrIGdldCB0aHJvdWdoP1xuICAgICAgICAgICAgdmFyICRiYW5uZXJCYWNrZ3JvdW5kID0gJHNsaWRlLmNoaWxkcmVuKFwiLmtvaC1iYW5uZXItYmFja2dyb3VuZFwiKTtcbiAgICAgICAgICAgIHZhciAkYmFubmVyQ29udGVudCA9ICRzbGlkZS5jaGlsZHJlbihcIi5rb2gtYmFubmVyLWNvbnRlbnRcIik7XG5cbiAgICAgICAgICAgIC8vaGlkZSBiYW5uZXIgdGl0bGUgJiBiYW5uZXIgc3VtbWFyeSBvbiBtb2JpbGUgc2NyZWVuc1xuXG4gICAgICAgICAgICB2YXIgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgICAgICAgICB2YXIgcGF0aCA9IHVybC5wYXRobmFtZTtcbiAgICAgICAgICAgIGlmKHBhdGggPT09IFwiL1wiIHx8IHBhdGggPT09IFwiL2VuXCIpIHtcbiAgICAgICAgICAgICAgICBpZigkKHdpbmRvdykud2lkdGgoKSA8IHNtYWxsU2NyZWVuV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgJChcIi52LWtvaC1oZXJvXCIpLmZpbmQoXCIua29oLWJhbm5lci10aXRsZVwiKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICQoXCIudi1rb2gtaGVyb1wiKS5maW5kKFwiLmtvaC1iYW5uZXItc3VtbWFyeVwiKS5oaWRlKCk7ICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRiYW5uZXJDb250ZW50LmNsaWNrKHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAkYmFubmVyQmFja2dyb3VuZFxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgJGJhbm5lckNvbnRlbnQgPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgIHZhciAkYmFubmVyQmFja2dyb3VuZCA9IGUuZGF0YS5iYWNrZ3JvdW5kO1xuXG4gICAgICAgICAgICAgICAgaWYgKCgkYmFubmVyQ29udGVudC5vZmZzZXQoKS50b3AgPT09ICRiYW5uZXJCYWNrZ3JvdW5kLm9mZnNldCgpLnRvcCkgJiZcbiAgICAgICAgICAgICAgICAgICAgKCRiYW5uZXJDb250ZW50Lm9mZnNldCgpLmxlZnQgPT09ICRiYW5uZXJCYWNrZ3JvdW5kLm9mZnNldCgpLmxlZnQpICYmXG4gICAgICAgICAgICAgICAgICAgICgkYmFubmVyQ29udGVudC5vdXRlcldpZHRoKCkgPT09ICRiYW5uZXJCYWNrZ3JvdW5kLm91dGVyV2lkdGgoKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKCRiYW5uZXJDb250ZW50Lm91dGVySGVpZ2h0KCkgPT09ICRiYW5uZXJCYWNrZ3JvdW5kLm91dGVySGVpZ2h0KCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkbGlua3MgPSAkYmFubmVyQmFja2dyb3VuZC5jaGlsZHJlbihcImFcIikuZmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogSGF2ZSB0byBkbyB0aGlzIHdpdGggYSBuYXRpdmUgSmF2YXNjcmlwdCBjbGljayBiZWNhdXNlXG4gICAgICAgICAgICAgICAgICAgIC8vIGpRdWVyeSBjbGljayBkb2VzIG5vdCB0cmlnZ2VyIGRlZmF1bHQgYnJvd3NlciBiZWhhdmlvclxuICAgICAgICAgICAgICAgICAgICBpZigkbGlua3MubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgXHQkbGlua3NbMF0uY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGluaXRPdmVybGF5UG9wb3ZlciA9IGZ1bmN0aW9uICgkc2xpZGUsICRidXR0b24sICRjb250ZW50LCB0b29sdGlwSUQpIHtcbiAgICAgICAgJGJ1dHRvbi5xdGlwKHtcbiAgICAgICAgICAgIGlkOiB0b29sdGlwSUQsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgdGV4dDogJGNvbnRlbnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwb3NpdGlvbjoge1xuICAgICAgICAgICAgICAgIG15OiAnYm90dG9tIHJpZ2h0JywgLy8gUG9zaXRpb24gbXkgdG9wIGxlZnQuLi5cbiAgICAgICAgICAgICAgICBhdDogJ2NlbnRlciBjZW50ZXInLCAvLyBhdCB0aGUgYm90dG9tIHJpZ2h0IG9mLi4uXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiAkc2xpZGUsXG4gICAgICAgICAgICAgICAgdmlld3BvcnQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlOiB7XG4gICAgICAgICAgICAgICAgd2hlbjoge1xuICAgICAgICAgICAgICAgICAgICBldmVudDogJ21vdXNlb3V0IHVuZm9jdXMnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmaXhlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBkZWxheTogMTAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBjbGFzc2VzOiAna29oLXF0aXAtcG9wb3ZlciBrb2gtY2Fyb3VzZWwtcG9wb3ZlciBxdGlwLWxpZ2h0IHF0aXAtc2hhZG93JyxcbiAgICAgICAgICAgICAgICB0aXA6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgaW5pdE92ZXJsYXlIb3RzcG90ID0gZnVuY3Rpb24gKCRzbGlkZSwgJGJ1dHRvbiwgJGNvbnRlbnQsIHRvb2x0aXBJRCkge1xuICAgICAgICAvLyBpZiBtb2JpbGVcbiAgICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgbW9iaWxlU2NyZWVuV2lkdGgpIHtcbiAgICAgICAgICAgIGlmICgkYnV0dG9uLmRhdGEoJ3F0aXAnKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICRidXR0b24ucXRpcCgnZGVzdHJveScsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGVsc2UgaWYgZGVza3RvcFxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICRidXR0b24ucXRpcCh7XG4gICAgICAgICAgICAgICAgaWQ6IHRvb2x0aXBJRCxcbiAgICAgICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICRjb250ZW50LmNsb25lKClcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIG15OiAncmlnaHQgdG9wJywgLy8gUG9zaXRpb24gbXkgdG9wIGxlZnQuLi5cbiAgICAgICAgICAgICAgICAgICAgYXQ6ICdsZWZ0IHRvcCcsIC8vIGF0IHRoZSBib3R0b20gcmlnaHQgb2YuLi5cbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiAkc2xpZGUsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdwb3J0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBhZGp1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ2ZsaXAgc2hpZnQnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgd2hlbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICdtb3VzZW91dCB1bmZvY3VzJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmaXhlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZGVsYXk6IDEwMFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogJ2tvaC1xdGlwLXBvcG92ZXIga29oLWNhcm91c2VsLXBvcG92ZXIgcXRpcC1saWdodCBxdGlwLXNoYWRvdycsXG4gICAgICAgICAgICAgICAgICAgIHRpcDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWltaWM6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiA1MCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAzMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMTVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qIEhlbHBlciBGdW5jdGlvbnMgKi9cbiAgICB2YXIgaW5pdEFzTW9kYWwgPSBmdW5jdGlvbiAoJGJ1dHRvbiwgJHBhbmVsLCByZW1vZGFsSUQpIHtcbiAgICAgICAgJHBhbmVsLmRhdGEoXCJyZW1vZGFsLWlkXCIsIHJlbW9kYWxJRCk7XG4gICAgICAgICRwYW5lbC5wcmVwZW5kKCc8YnV0dG9uIGRhdGEtcmVtb2RhbC1hY3Rpb249XCJjbG9zZVwiIGNsYXNzPVwicmVtb2RhbC1jbG9zZVwiPjwvYnV0dG9uPicpO1xuICAgICAgICAkcGFuZWwuYXR0cihcImRhdGEta29oLWNvbXBvbmVudFwiLCBcImMta29oLWJhbm5lci1jYXJvdXNlbFwiKTtcbiAgICAgICAgJHBhbmVsLmFkZENsYXNzKFwiYy1rb2gtYmFubmVyLWNhcm91c2VsLW1vZGFsXCIpO1xuXG4gICAgICAgIHZhciAkcmVtb2RhbFBhbmVsID0gJHBhbmVsLnJlbW9kYWwoe1xuICAgICAgICAgICAgaGFzaFRyYWNraW5nOiB0cnVlLFxuICAgICAgICAgICAgY2xvc2VPbkNhbmNlbDogdHJ1ZSxcbiAgICAgICAgICAgIGNsb3NlT25Fc2NhcGU6IHRydWUsXG4gICAgICAgICAgICBjbG9zZU9uT3V0c2lkZUNsaWNrOiB0cnVlLFxuICAgICAgICAgICAgbW9kaWZpZXI6ICcnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE1ha2UgdGhlIGJ1dHRvbiBhbGwgYnV0dG9uLXkgYW5kIGNsaWNrLXlcbiAgICAgICAgJGJ1dHRvbi5kYXRhKFwicmVtb2RhbC10YXJnZXRcIiwgcmVtb2RhbElEKTtcbiAgICAgICAgJGJ1dHRvbi5jbGljayh7XG4gICAgICAgICAgICB0YXJnZXQ6ICRyZW1vZGFsUGFuZWxcbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB2YXIgJHRhcmdldCA9IGUuZGF0YS50YXJnZXQ7XG4gICAgICAgICAgICAkdGFyZ2V0Lm9wZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV2hlbiBtb2RhbCBpcyBjbG9zZWQsIHJlc2V0IHNyYyBvbiBhbnkgWW91VHViZSBpZnJhbWVzIHRvIHN0b3AgdmlkZW9zXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbG9zZWQnLCAkcmVtb2RhbFBhbmVsLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUudGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgYXhLT0gudXRpbHMuc3RvcFZpZGVvcyhlLnRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgdG9nZ2xlT3BlbiA9IGZ1bmN0aW9uICgkdGFyZ2V0KSB7XG4gICAgICAgIGlmICgkdGFyZ2V0Lmhhc0NsYXNzKFwib3BlblwiKSkge1xuICAgICAgICAgICAgJHRhcmdldC5yZW1vdmVDbGFzcyhcIm9wZW5cIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkdGFyZ2V0LmFkZENsYXNzKFwib3BlblwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgbWFrZVZpZGVvUmVzcG9uc2l2ZSA9IGZ1bmN0aW9uICgkdmlkZW9FbGVtZW50KSB7XG4gICAgICAgIHZhciBhc3BlY3RSYXRpbyA9ICR2aWRlb0VsZW1lbnQuZGF0YSgnYXNwZWN0cmF0aW8nKTtcbiAgICAgICAgdmFyIG1heFdpZHRoID0gJHZpZGVvRWxlbWVudC5kYXRhKCdtYXh3aWR0aCcpO1xuXG4gICAgICAgIGlmICghYXNwZWN0UmF0aW8gfHwgIW1heFdpZHRoKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSAkdmlkZW9FbGVtZW50LndpZHRoKCk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gJHZpZGVvRWxlbWVudC5oZWlnaHQoKTtcblxuICAgICAgICAgICAgYXNwZWN0UmF0aW8gPSBoZWlnaHQgLyB3aWR0aDtcblxuICAgICAgICAgICAgLy8gRmluZCBhbmQgc2F2ZSB0aGUgYXNwZWN0IHJhdGlvLCBhbmQgdGhlIG9yaWdpbmFsIHdpZHRoXG4gICAgICAgICAgICAkdmlkZW9FbGVtZW50LmRhdGEoJ2FzcGVjdHJhdGlvJywgYXNwZWN0UmF0aW8pO1xuICAgICAgICAgICAgJHZpZGVvRWxlbWVudC5kYXRhKCdtYXh3aWR0aCcsIHdpZHRoKTtcbiAgICAgICAgICAgICR2aWRlb0VsZW1lbnQucmVtb3ZlQXR0cignd2lkdGgnKTtcbiAgICAgICAgICAgICR2aWRlb0VsZW1lbnQucmVtb3ZlQXR0cignaGVpZ2h0Jyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHJlc2l6ZVJlc3BvbnNpdmVWaWRlbyA9IGZ1bmN0aW9uICgkdmlkZW9FbGVtZW50KSB7XG4gICAgICAgIHZhciBlbWJlZFRhZ3MgPSBcImlmcmFtZSwgb2JqZWN0LCBlbWJlZFwiO1xuICAgICAgICB2YXIgYXNwZWN0UmF0aW8gPSAkdmlkZW9FbGVtZW50LmRhdGEoJ2FzcGVjdHJhdGlvJyk7XG4gICAgICAgIHZhciBtYXhXaWR0aCA9ICR2aWRlb0VsZW1lbnQuZGF0YSgnbWF4d2lkdGgnKTtcblxuICAgICAgICBpZiAoIWFzcGVjdFJhdGlvIHx8ICFtYXhXaWR0aCkge1xuICAgICAgICAgICAgbWFrZVZpZGVvUmVzcG9uc2l2ZSgkdmlkZW9FbGVtZW50KTtcbiAgICAgICAgICAgIGFzcGVjdFJhdGlvID0gJHZpZGVvRWxlbWVudC5kYXRhKCdhc3BlY3RyYXRpbycpO1xuICAgICAgICAgICAgbWF4V2lkdGggPSAkdmlkZW9FbGVtZW50LmRhdGEoJ21heHdpZHRoJyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgJHBhcmVudCA9ICR2aWRlb0VsZW1lbnQuY2xvc2VzdCgnOm5vdCgnICsgZW1iZWRUYWdzICsgJyknKTtcblxuICAgICAgICB2YXIgcmVzcG9uc2l2ZVdpZHRoID0gMzIwOyAvLyBpbiBjYXNlIHdlIGNhbid0IGZpbmQgYSBwYXJlbnQsIHNldCB0byBzbWFsbGVzdCBwb3NzaWJsZSBzY3JlZW4gd2lkdGhcbiAgICAgICAgaWYgKCRwYXJlbnQpIHtcbiAgICAgICAgICAgIHJlc3BvbnNpdmVXaWR0aCA9ICRwYXJlbnQud2lkdGgoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb24ndCBleGNlZWQgdGhlIG9yaWdpbmFsIHdpZHRoIChpLmUuIGRvbid0IHNjYWxlIHVwLCBvbmx5IGRvd24pXG4gICAgICAgIHJlc3BvbnNpdmVXaWR0aCA9IE1hdGgubWluKHJlc3BvbnNpdmVXaWR0aCwgbWF4V2lkdGgpO1xuXG4gICAgICAgICR2aWRlb0VsZW1lbnQud2lkdGgocmVzcG9uc2l2ZVdpZHRoKTtcbiAgICAgICAgJHZpZGVvRWxlbWVudC5oZWlnaHQocmVzcG9uc2l2ZVdpZHRoICogYXNwZWN0UmF0aW8pO1xuICAgIH07XG5cbiAgICB2YXIgdGltZXJzID0ge307XG4gICAgdmFyIHdhaXRGb3JGaW5hbEV2ZW50ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBtcywgdW5pcXVlSWQpIHtcbiAgICAgICAgaWYgKCF1bmlxdWVJZCkge1xuICAgICAgICAgICAgdW5pcXVlSWQgPSBcIlVOSVFVRUlEXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRpbWVyc1t1bmlxdWVJZF0pIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnNbdW5pcXVlSWRdKTtcbiAgICAgICAgfVxuICAgICAgICB0aW1lcnNbdW5pcXVlSWRdID0gc2V0VGltZW91dChjYWxsYmFjaywgbXMpO1xuICAgIH07XG5cblxuICAgIC8qIERlZmluZXMgZnVuY3Rpb25zIGV4cG9zZWQgdGhyb3VnaCBvYmplY3QgKi9cbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpbml0Q2Fyb3VzZWwoKTtcbiAgICAgICAgICAgIGluaXRTaG9wcGluZ0d1aWRlQ2Fyb3VzZWwoKTtcbiAgICAgICAgfVxuICAgIH07XG59KSgpO1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGV4ZWN1dGVzIHdoZW4gSFRNTC1Eb2N1bWVudCBpcyBsb2FkZWQgYW5kIERPTSBpcyByZWFkeVxuICAgICAgICBheEtPSC5tYWluLmNhcm91c2VsTWFuYWdlci5pbml0KCk7XG4gICAgfSk7XG59KTtcbiJdfQ==
