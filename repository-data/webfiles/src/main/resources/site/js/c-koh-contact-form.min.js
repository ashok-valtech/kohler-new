/*
 * Copyright © 2000-2017 Kohler Company. All Rights Reserved.
 */
var axKOH=axKOH||{};axKOH.main=axKOH.main||{},axKOH.main.componentManager=axKOH.main.componentManager||{},axKOH.main.componentManager.contactForm=function(){var componentClass="c-koh-contact-form",initComponents=function(){var $components=$("."+componentClass);$components.each(function(componentIndex){var $component=$(this),$contactForm=$component.find("form"),$contactToggle=$component.find(".koh-contact-toggle").children("input"),$contactPhotos=$contactForm.find(".koh-contact-photo"),$captchaError=($contactForm.find("#newsletter"),$contactForm.find(".koh-contact-captcha .error-message")),$countrySelector=$contactForm.find(".country").children("select"),$stateSelector=$contactForm.find(".state").children("select");$contactToggle.change(function(){var toggleChoice=$(this).val();"yes"===toggleChoice?($(".koh-contact-fields").hide(),$(".koh-contact-fields.v-yes").show()):($(".koh-contact-fields").hide(),$(".koh-contact-fields.v-no").show()),$contactForm.each(function(){$(this)[0].reset()})}),!function(e){e.fn.niceSelect=function(t){function s(t){t.after(e("<div></div>").addClass("nice-select").addClass(t.attr("class")||"").addClass(t.attr("disabled")?"disabled":"").attr("tabindex",t.attr("disabled")?null:"0").html('<span class="current"></span><ul class="list"></ul>'));var s=t.next(),n=t.find("option"),i=t.find("option:selected");s.find(".current").html(i.data("display")||i.text()),n.each(function(t){var n=e(this),i=n.data("display");s.find("ul").append(e("<li></li>").attr("data-value",n.val()).attr("data-display",i||null).addClass("option"+(n.is(":selected")?" selected":"")+(n.is(":disabled")?" disabled":"")).html(n.text()))})}if("string"==typeof t)return"update"==t?this.each(function(){var t=e(this),n=e(this).next(".nice-select"),i=n.hasClass("open");n.length&&(n.remove(),s(t),i&&t.next().trigger("click"))}):"destroy"==t?(this.each(function(){var t=e(this),s=e(this).next(".nice-select");s.length&&(s.remove(),t.css("display",""))}),0==e(".nice-select").length&&e(document).off(".nice_select")):console.log('Method "'+t+'" does not exist.'),this;this.hide(),this.each(function(){var t=e(this);t.next().hasClass("nice-select")||s(t)}),e(document).off(".nice_select"),e(document).on("click.nice_select",".nice-select",function(t){var s=e(this);e(".nice-select").not(s).removeClass("open"),s.toggleClass("open"),s.hasClass("open")?(s.find(".option"),s.find(".focus").removeClass("focus"),s.find(".selected").addClass("focus")):s.focus()}),e(document).on("click.nice_select",function(t){0===e(t.target).closest(".nice-select").length&&e(".nice-select").removeClass("open").find(".option")}),e(document).on("click.nice_select",".nice-select .option:not(.disabled)",function(t){var s=e(this),n=s.closest(".nice-select");n.find(".selected").removeClass("selected"),s.addClass("selected");var i=s.data("display")||s.text();n.find(".current").text(i),n.prev("select").val(s.data("value")).trigger("change")}),e(document).on("keydown.nice_select",".nice-select",function(t){var s=e(this),n=e(s.find(".focus")||s.find(".list .option.selected"));if(32==t.keyCode||13==t.keyCode)return s.hasClass("open")?n.trigger("click"):s.trigger("click"),!1;if(40==t.keyCode){if(s.hasClass("open")){var i=n.nextAll(".option:not(.disabled)").first();i.length>0&&(s.find(".focus").removeClass("focus"),i.addClass("focus"))}else s.trigger("click");return!1}if(38==t.keyCode){if(s.hasClass("open")){var l=n.prevAll(".option:not(.disabled)").first();l.length>0&&(s.find(".focus").removeClass("focus"),l.addClass("focus"))}else s.trigger("click");return!1}if(27==t.keyCode)s.hasClass("open")&&s.trigger("click");else if(9==t.keyCode&&s.hasClass("open"))return!1});var n=document.createElement("a").style;return n.cssText="pointer-events:auto","auto"!==n.pointerEvents&&e("html").addClass("no-csspointerevents"),this}}(jQuery),$(".c-koh-contact-form select").niceSelect(),$countrySelector.change(function(e){var selectedCountry=$(e.target).next(".nice-select").find(".selected").text();$stateSelector.removeAttr("disabled").parent().removeClass("disabled"),$stateSelector.attr("name").length>0&&$.get("/api/dealerlookup/"+selectedCountry,function(data){$stateSelector.html(data),$(".c-koh-contact-form select").niceSelect("update")}),$(".c-koh-contact-form select").niceSelect("update")}),$contactPhotos.each(function(){function readURL(input){if(input.files&&input.files[0]){var photoPreview=$photoInput.parent().find(".preview");photoPreview.html("");var reader=new FileReader;reader.onload=function(e){var img=$("<img />");img.attr("style","height:41px;"),img.attr("src",e.target.result),photoPreview.append(img)},reader.readAsDataURL(input.files[0])}}var $photoInput=$(this).find("input[type=file]");$photoInput.parsley().on("field:success",function(){var inputID=$photoInput.attr("id"),inputTarget="#"+inputID,inputValue=document.getElementById(inputID);readURL(inputValue),$(inputTarget).parent().find(".koh-photo-remove").show(),$contactForm.find("#terms").prop("required",!0)})}),$contactForm.parsley({errorClass:"error",classHandler:function(el){return el.$element.closest("div")},errorsWrapper:'<div class="error-message"></div>',errorTemplate:"<span></span>"}),window.Parsley.addValidator("textfield",{requirementType:"regexp",validateString:function(value,requirement){return/^[0-9A-Za-z _@',\-]+$/i.test(value)},messages:{en:"Invalid characters detected.","pt-br":"Caracteres inválidos detectados"}}),window.Parsley.addValidator("textarea",{requirementType:"regexp",validateString:function(value,requirement){return/^[0-9A-Za-z _@',.!_\/$\-]+$/i.test(value)},messages:{en:"Invalid characters detected.","pt-br":"Caracteres inválidos detectados"}}),window.Parsley.addValidator("filesize",{validateString:function(_value,maxSize,parsleyInstance){var files=parsleyInstance.$element[0].files;return 1!=files.length||files[0].size<=1024*maxSize*1024},requirementType:"integer",messages:{en:"Photo cannot be larger than %s MB","pt-br":"Foto não pode ser maior que %s MB"}}),window.Parsley.addValidator("filetype",{requirementType:"string",validateString:function(value,requirement,parsleyInstance){var file=parsleyInstance.$element[0].files;if(0==file.length)return!0;var allowedMimeTypes=requirement.replace(/\s/g,"").split(",");return-1!==allowedMimeTypes.indexOf(file[0].type)},messages:{en:"Photo must be a JPG, GIF, PNG or BMP","pt-br":"A foto deve ser JPG, GIF, PNG or BMP"}}),$(this).on("click",".koh-photo-remove",function(e){var prevInput=$(this).parent().find("input[type=file]").attr("id"),prevID=$("#"+prevInput),prevImg=$(this).parent().find(".preview img"),totalImg=$(".koh-contact-photo.parsley-success").length;$(this).hide(),prevID.parsley().reset(),prevID.val(""),prevImg.remove(),1>=totalImg&&$contactForm.find("#terms").prop("required",!1)}),$contactForm.on("submit",function(e){if($(this).parent().hasClass("v-yes")){var response=grecaptcha.getResponse(widgetId1);0==response.length&&(e.preventDefault(),$captchaError.show())}if($(this).parent().hasClass("v-no")){var response=grecaptcha.getResponse(widgetId2);0==response.length&&(e.preventDefault(),$captchaError.show())}return e.isDefaultPrevented()?!1:!0})})};return{initialize:function(){initComponents()},onLoad:function(){}}}();var verifyCallback=function(response){$(".koh-contact-captcha .error-message").hide()},widgetId1,widgetId2,captchaKey=$("#captchaKey").val(),onloadCallback=function(){widgetId1=grecaptcha.render("recaptcha1",{sitekey:captchaKey,callback:verifyCallback}),widgetId2=grecaptcha.render("recaptcha2",{sitekey:captchaKey,callback:verifyCallback})};$(function(){$(document).ready(function(){axKOH.main.componentManager.contactForm.initialize()}),$(window).load(function(){axKOH.main.componentManager.contactForm.onLoad()})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImMta29oLWNvbnRhY3QtZm9ybS5qcyJdLCJuYW1lcyI6WyJheEtPSCIsIm1haW4iLCJjb21wb25lbnRNYW5hZ2VyIiwiY29udGFjdEZvcm0iLCJjb21wb25lbnRDbGFzcyIsImluaXRDb21wb25lbnRzIiwiJGNvbXBvbmVudHMiLCIkIiwiZWFjaCIsImNvbXBvbmVudEluZGV4IiwiJGNvbXBvbmVudCIsInRoaXMiLCIkY29udGFjdEZvcm0iLCJmaW5kIiwiJGNvbnRhY3RUb2dnbGUiLCJjaGlsZHJlbiIsIiRjb250YWN0UGhvdG9zIiwiJGNhcHRjaGFFcnJvciIsIiRjb3VudHJ5U2VsZWN0b3IiLCIkc3RhdGVTZWxlY3RvciIsImNoYW5nZSIsInRvZ2dsZUNob2ljZSIsInZhbCIsImhpZGUiLCJzaG93IiwicmVzZXQiLCJlIiwiZm4iLCJuaWNlU2VsZWN0IiwidCIsInMiLCJhZnRlciIsImFkZENsYXNzIiwiYXR0ciIsImh0bWwiLCJuZXh0IiwibiIsImkiLCJkYXRhIiwidGV4dCIsImFwcGVuZCIsImlzIiwiaGFzQ2xhc3MiLCJsZW5ndGgiLCJyZW1vdmUiLCJ0cmlnZ2VyIiwiY3NzIiwiZG9jdW1lbnQiLCJvZmYiLCJjb25zb2xlIiwibG9nIiwib24iLCJub3QiLCJyZW1vdmVDbGFzcyIsInRvZ2dsZUNsYXNzIiwiZm9jdXMiLCJ0YXJnZXQiLCJjbG9zZXN0IiwicHJldiIsImtleUNvZGUiLCJuZXh0QWxsIiwiZmlyc3QiLCJsIiwicHJldkFsbCIsImNyZWF0ZUVsZW1lbnQiLCJzdHlsZSIsImNzc1RleHQiLCJwb2ludGVyRXZlbnRzIiwialF1ZXJ5Iiwic2VsZWN0ZWRDb3VudHJ5IiwicmVtb3ZlQXR0ciIsInBhcmVudCIsImdldCIsInJlYWRVUkwiLCJpbnB1dCIsImZpbGVzIiwicGhvdG9QcmV2aWV3IiwiJHBob3RvSW5wdXQiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwiaW1nIiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsInBhcnNsZXkiLCJpbnB1dElEIiwiaW5wdXRUYXJnZXQiLCJpbnB1dFZhbHVlIiwiZ2V0RWxlbWVudEJ5SWQiLCJwcm9wIiwiZXJyb3JDbGFzcyIsImNsYXNzSGFuZGxlciIsImVsIiwiJGVsZW1lbnQiLCJlcnJvcnNXcmFwcGVyIiwiZXJyb3JUZW1wbGF0ZSIsIndpbmRvdyIsIlBhcnNsZXkiLCJhZGRWYWxpZGF0b3IiLCJyZXF1aXJlbWVudFR5cGUiLCJ2YWxpZGF0ZVN0cmluZyIsInZhbHVlIiwicmVxdWlyZW1lbnQiLCJ0ZXN0IiwibWVzc2FnZXMiLCJlbiIsInB0LWJyIiwiX3ZhbHVlIiwibWF4U2l6ZSIsInBhcnNsZXlJbnN0YW5jZSIsInNpemUiLCJmaWxlIiwiYWxsb3dlZE1pbWVUeXBlcyIsInJlcGxhY2UiLCJzcGxpdCIsImluZGV4T2YiLCJ0eXBlIiwicHJldklucHV0IiwicHJldklEIiwicHJldkltZyIsInRvdGFsSW1nIiwicmVzcG9uc2UiLCJncmVjYXB0Y2hhIiwiZ2V0UmVzcG9uc2UiLCJ3aWRnZXRJZDEiLCJwcmV2ZW50RGVmYXVsdCIsIndpZGdldElkMiIsImlzRGVmYXVsdFByZXZlbnRlZCIsImluaXRpYWxpemUiLCJvbkxvYWQiLCJ2ZXJpZnlDYWxsYmFjayIsImNhcHRjaGFLZXkiLCJvbmxvYWRDYWxsYmFjayIsInJlbmRlciIsInNpdGVrZXkiLCJjYWxsYmFjayIsInJlYWR5IiwibG9hZCJdLCJtYXBwaW5ncyI6Ijs7O0FBS0EsR0FBSUEsT0FBUUEsU0FDWkEsT0FBTUMsS0FBT0QsTUFBTUMsU0FDbkJELE1BQU1DLEtBQUtDLGlCQUFtQkYsTUFBTUMsS0FBS0MscUJBR3pDRixNQUFNQyxLQUFLQyxpQkFBaUJDLFlBQWMsV0FDekMsR0FBSUMsZ0JBQWlCLHFCQUdqQkMsZUFBaUIsV0FFcEIsR0FBSUMsYUFBY0MsRUFBRSxJQUFJSCxlQUd4QkUsYUFBWUUsS0FBTSxTQUFTQyxnQkFDMUIsR0FBSUMsWUFBYUgsRUFBRUksTUFFZkMsYUFBZ0JGLFdBQVdHLEtBQUssUUFDaENDLGVBQWlC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ZEosVUFBWUosV0FBV1csT0FBTyxjQUM3QkMsUUFBWUgsV0FDWkksU0FBYUwsaUJBSWYzSCxHQUFFLFdBQ0RBLEVBQUV3QyxVQUFVeUYsTUFBTSxXQUVqQnhJLE1BQU1DLEtBQUtDLGlCQUFpQkMsWUFBWTZILGVBR3pDekgsRUFBRXlGLFFBQVF5QyxLQUFLLFdBRWR6SSxNQUFNQyxLQUFLQyxpQkFBaUJDLFlBQVk4SCIsImZpbGUiOiJjLWtvaC1jb250YWN0LWZvcm0ubWluLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCDCqSAyMDAwLTIwMTcgS29obGVyIENvbXBhbnkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKi9cblxuLy8gSmF2YXNjcmlwdCBOYW1lc3BhY2luZyBzZXR1cFxudmFyIGF4S09IID0gYXhLT0ggfHwge307XG5heEtPSC5tYWluID0gYXhLT0gubWFpbiB8fCB7fTtcbmF4S09ILm1haW4uY29tcG9uZW50TWFuYWdlciA9IGF4S09ILm1haW4uY29tcG9uZW50TWFuYWdlciB8fCB7fTtcblxuLy8gUmVwbGFjZSBcImNvbXBvbmVudE5hbWVcIiB3aXRoIHNvbWV0aGluZyByZXByZXNlbnRpbmcgd2hpY2ggY29tcG9uZW50IHRoaXMgaXNcbmF4S09ILm1haW4uY29tcG9uZW50TWFuYWdlci5jb250YWN0Rm9ybSA9IChmdW5jdGlvbiAoKSB7XG5cdHZhciBjb21wb25lbnRDbGFzcyA9IFwiYy1rb2gtY29udGFjdC1mb3JtXCI7XG5cblx0Ly8gTWFpbiBpbml0IGZ1bmN0aW9uOyBjb250YWlucyB0aGUgbWFpbiBsb29wIHRocm91Z2ggY29tcG9uZW50IGluc3RhbmNlc1xuXHR2YXIgaW5pdENvbXBvbmVudHMgPSBmdW5jdGlvbigpIHtcblx0XHQvLyBGaW5kIGFsbCBpbnN0YW5jZXMgb2YgdGhlIGNvbXBvbmVudCBvbiB0aGUgcGFnZVxuXHRcdHZhciAkY29tcG9uZW50cyA9ICQoXCIuXCIrY29tcG9uZW50Q2xhc3MpO1xuXG5cdFx0Ly8gRm9yIGVhY2ggY29tcG9uZW50IGluc3RhbmNlLCBpbml0aWFsaXplIGl0XG5cdFx0JGNvbXBvbmVudHMuZWFjaCggZnVuY3Rpb24oY29tcG9uZW50SW5kZXgpIHtcblx0XHRcdHZhciAkY29tcG9uZW50ID0gJCh0aGlzKTsgLy8gdGhlIHNpbmdsZSBjb21wb25lbnQgaW5zdGFuY2Ugd2UncmUgY3VycmVudGx5IG9wZXJhdGluZyBvblxuXG5cdFx0XHR2YXIgJGNvbnRhY3RGb3JtXHRcdD0gJGNvbXBvbmVudC5maW5kKFwiZm9ybVwiKTtcblx0XHRcdHZhciAkY29udGFjdFRvZ2dsZVx0PSAkY29tcG9uZW50LmZpbmQoXCIua29oLWNvbnRhY3QtdG9nZ2xlXCIpLmNoaWxkcmVuKFwiaW5wdXRcIik7XG5cdFx0XHR2YXIgJGNvbnRhY3RQaG90b3NcdD0gJGNvbnRhY3RGb3JtLmZpbmQoXCIua29oLWNvbnRhY3QtcGhvdG9cIik7XG5cdFx0XHR2YXIgJGNvbnRhY3RUZXJtc1x0XHQ9ICRjb250YWN0Rm9ybS5maW5kKFwiI25ld3NsZXR0ZXJcIik7XG5cdFx0XHR2YXIgJGNhcHRjaGFFcnJvciAgID0gJGNvbnRhY3RGb3JtLmZpbmQoXCIua29oLWNvbnRhY3QtY2FwdGNoYSAuZXJyb3ItbWVzc2FnZVwiKTtcblxuXHRcdFx0dmFyICRjb3VudHJ5U2VsZWN0b3IgXHQ9ICRjb250YWN0Rm9ybS5maW5kKFwiLmNvdW50cnlcIikuY2hpbGRyZW4oXCJzZWxlY3RcIik7XG5cdFx0XHR2YXIgJHN0YXRlU2VsZWN0b3IgXHRcdD0gJGNvbnRhY3RGb3JtLmZpbmQoXCIuc3RhdGVcIikuY2hpbGRyZW4oXCJzZWxlY3RcIik7XG5cblxuXG5cblx0XHRcdC8vIFNob3cgZGlmZmVyZW50IGZvcm1zIG9uIHNlbGVjdGlvblxuXHRcdFx0JGNvbnRhY3RUb2dnbGUuY2hhbmdlKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0dmFyIHRvZ2dsZUNob2ljZSA9ICQodGhpcykudmFsKCk7XG5cdFx0XHRcdGlmICh0b2dnbGVDaG9pY2UgPT09IFwieWVzXCIpIHtcblx0XHRcdFx0XHQkKFwiLmtvaC1jb250YWN0LWZpZWxkc1wiKS5oaWRlKCk7XG5cdFx0XHRcdFx0JChcIi5rb2gtY29udGFjdC1maWVsZHMudi15ZXNcIikuc2hvdygpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCQoXCIua29oLWNvbnRhY3QtZmllbGRzXCIpLmhpZGUoKTtcblx0XHRcdFx0XHQkKFwiLmtvaC1jb250YWN0LWZpZWxkcy52LW5vXCIpLnNob3coKTtcblx0XHRcdFx0fVxuXG4gICAgICAgICRjb250YWN0Rm9ybS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgJCh0aGlzKVswXS5yZXNldCgpO1xuICAgICAgICB9KTtcblx0XHRcdH0pO1xuXG5cblxuXHRcdFx0LyogIGpRdWVyeSBOaWNlIFNlbGVjdCAtIHYxLjBcblx0ICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9oZXJuYW5zYXJ0b3Jpby9qcXVlcnktbmljZS1zZWxlY3Rcblx0ICAgIE1hZGUgYnkgSGVybsOhbiBTYXJ0b3JpbyAgKi9cblx0XHRcdCFmdW5jdGlvbihlKXtlLmZuLm5pY2VTZWxlY3Q9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gcyh0KXt0LmFmdGVyKGUoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyhcIm5pY2Utc2VsZWN0XCIpLmFkZENsYXNzKHQuYXR0cihcImNsYXNzXCIpfHxcIlwiKS5hZGRDbGFzcyh0LmF0dHIoXCJkaXNhYmxlZFwiKT9cImRpc2FibGVkXCI6XCJcIikuYXR0cihcInRhYmluZGV4XCIsdC5hdHRyKFwiZGlzYWJsZWRcIik/bnVsbDpcIjBcIikuaHRtbCgnPHNwYW4gY2xhc3M9XCJjdXJyZW50XCI+PC9zcGFuPjx1bCBjbGFzcz1cImxpc3RcIj48L3VsPicpKTt2YXIgcz10Lm5leHQoKSxuPXQuZmluZChcIm9wdGlvblwiKSxpPXQuZmluZChcIm9wdGlvbjpzZWxlY3RlZFwiKTtzLmZpbmQoXCIuY3VycmVudFwiKS5odG1sKGkuZGF0YShcImRpc3BsYXlcIil8fGkudGV4dCgpKSxuLmVhY2goZnVuY3Rpb24odCl7dmFyIG49ZSh0aGlzKSxpPW4uZGF0YShcImRpc3BsYXlcIik7cy5maW5kKFwidWxcIikuYXBwZW5kKGUoXCI8bGk+PC9saT5cIikuYXR0cihcImRhdGEtdmFsdWVcIixuLnZhbCgpKS5hdHRyKFwiZGF0YS1kaXNwbGF5XCIsaXx8bnVsbCkuYWRkQ2xhc3MoXCJvcHRpb25cIisobi5pcyhcIjpzZWxlY3RlZFwiKT9cIiBzZWxlY3RlZFwiOlwiXCIpKyhuLmlzKFwiOmRpc2FibGVkXCIpP1wiIGRpc2FibGVkXCI6XCJcIikpLmh0bWwobi50ZXh0KCkpKX0pfWlmKFwic3RyaW5nXCI9PXR5cGVvZiB0KXJldHVyblwidXBkYXRlXCI9PXQ/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxuPWUodGhpcykubmV4dChcIi5uaWNlLXNlbGVjdFwiKSxpPW4uaGFzQ2xhc3MoXCJvcGVuXCIpO24ubGVuZ3RoJiYobi5yZW1vdmUoKSxzKHQpLGkmJnQubmV4dCgpLnRyaWdnZXIoXCJjbGlja1wiKSl9KTpcImRlc3Ryb3lcIj09dD8odGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxzPWUodGhpcykubmV4dChcIi5uaWNlLXNlbGVjdFwiKTtzLmxlbmd0aCYmKHMucmVtb3ZlKCksdC5jc3MoXCJkaXNwbGF5XCIsXCJcIikpfSksMD09ZShcIi5uaWNlLXNlbGVjdFwiKS5sZW5ndGgmJmUoZG9jdW1lbnQpLm9mZihcIi5uaWNlX3NlbGVjdFwiKSk6Y29uc29sZS5sb2coJ01ldGhvZCBcIicrdCsnXCIgZG9lcyBub3QgZXhpc3QuJyksdGhpczt0aGlzLmhpZGUoKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpO3QubmV4dCgpLmhhc0NsYXNzKFwibmljZS1zZWxlY3RcIil8fHModCl9KSxlKGRvY3VtZW50KS5vZmYoXCIubmljZV9zZWxlY3RcIiksZShkb2N1bWVudCkub24oXCJjbGljay5uaWNlX3NlbGVjdFwiLFwiLm5pY2Utc2VsZWN0XCIsZnVuY3Rpb24odCl7dmFyIHM9ZSh0aGlzKTtlKFwiLm5pY2Utc2VsZWN0XCIpLm5vdChzKS5yZW1vdmVDbGFzcyhcIm9wZW5cIikscy50b2dnbGVDbGFzcyhcIm9wZW5cIikscy5oYXNDbGFzcyhcIm9wZW5cIik/KHMuZmluZChcIi5vcHRpb25cIikscy5maW5kKFwiLmZvY3VzXCIpLnJlbW92ZUNsYXNzKFwiZm9jdXNcIikscy5maW5kKFwiLnNlbGVjdGVkXCIpLmFkZENsYXNzKFwiZm9jdXNcIikpOnMuZm9jdXMoKX0pLGUoZG9jdW1lbnQpLm9uKFwiY2xpY2submljZV9zZWxlY3RcIixmdW5jdGlvbih0KXswPT09ZSh0LnRhcmdldCkuY2xvc2VzdChcIi5uaWNlLXNlbGVjdFwiKS5sZW5ndGgmJmUoXCIubmljZS1zZWxlY3RcIikucmVtb3ZlQ2xhc3MoXCJvcGVuXCIpLmZpbmQoXCIub3B0aW9uXCIpfSksZShkb2N1bWVudCkub24oXCJjbGljay5uaWNlX3NlbGVjdFwiLFwiLm5pY2Utc2VsZWN0IC5vcHRpb246bm90KC5kaXNhYmxlZClcIixmdW5jdGlvbih0KXt2YXIgcz1lKHRoaXMpLG49cy5jbG9zZXN0KFwiLm5pY2Utc2VsZWN0XCIpO24uZmluZChcIi5zZWxlY3RlZFwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpLHMuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTt2YXIgaT1zLmRhdGEoXCJkaXNwbGF5XCIpfHxzLnRleHQoKTtuLmZpbmQoXCIuY3VycmVudFwiKS50ZXh0KGkpLG4ucHJldihcInNlbGVjdFwiKS52YWwocy5kYXRhKFwidmFsdWVcIikpLnRyaWdnZXIoXCJjaGFuZ2VcIil9KSxlKGRvY3VtZW50KS5vbihcImtleWRvd24ubmljZV9zZWxlY3RcIixcIi5uaWNlLXNlbGVjdFwiLGZ1bmN0aW9uKHQpe3ZhciBzPWUodGhpcyksbj1lKHMuZmluZChcIi5mb2N1c1wiKXx8cy5maW5kKFwiLmxpc3QgLm9wdGlvbi5zZWxlY3RlZFwiKSk7aWYoMzI9PXQua2V5Q29kZXx8MTM9PXQua2V5Q29kZSlyZXR1cm4gcy5oYXNDbGFzcyhcIm9wZW5cIik/bi50cmlnZ2VyKFwiY2xpY2tcIik6cy50cmlnZ2VyKFwiY2xpY2tcIiksITE7aWYoNDA9PXQua2V5Q29kZSl7aWYocy5oYXNDbGFzcyhcIm9wZW5cIikpe3ZhciBpPW4ubmV4dEFsbChcIi5vcHRpb246bm90KC5kaXNhYmxlZClcIikuZmlyc3QoKTtpLmxlbmd0aD4wJiYocy5maW5kKFwiLmZvY3VzXCIpLnJlbW92ZUNsYXNzKFwiZm9jdXNcIiksaS5hZGRDbGFzcyhcImZvY3VzXCIpKX1lbHNlIHMudHJpZ2dlcihcImNsaWNrXCIpO3JldHVybiExfWlmKDM4PT10LmtleUNvZGUpe2lmKHMuaGFzQ2xhc3MoXCJvcGVuXCIpKXt2YXIgbD1uLnByZXZBbGwoXCIub3B0aW9uOm5vdCguZGlzYWJsZWQpXCIpLmZpcnN0KCk7bC5sZW5ndGg+MCYmKHMuZmluZChcIi5mb2N1c1wiKS5yZW1vdmVDbGFzcyhcImZvY3VzXCIpLGwuYWRkQ2xhc3MoXCJmb2N1c1wiKSl9ZWxzZSBzLnRyaWdnZXIoXCJjbGlja1wiKTtyZXR1cm4hMX1pZigyNz09dC5rZXlDb2RlKXMuaGFzQ2xhc3MoXCJvcGVuXCIpJiZzLnRyaWdnZXIoXCJjbGlja1wiKTtlbHNlIGlmKDk9PXQua2V5Q29kZSYmcy5oYXNDbGFzcyhcIm9wZW5cIikpcmV0dXJuITF9KTt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKS5zdHlsZTtyZXR1cm4gbi5jc3NUZXh0PVwicG9pbnRlci1ldmVudHM6YXV0b1wiLFwiYXV0b1wiIT09bi5wb2ludGVyRXZlbnRzJiZlKFwiaHRtbFwiKS5hZGRDbGFzcyhcIm5vLWNzc3BvaW50ZXJldmVudHNcIiksdGhpc319KGpRdWVyeSk7XG5cblx0XHRcdCQoJy5jLWtvaC1jb250YWN0LWZvcm0gc2VsZWN0JykubmljZVNlbGVjdCgpO1xuXG5cdFx0XHQkY291bnRyeVNlbGVjdG9yLmNoYW5nZShmdW5jdGlvbihlKXtcbiAgICAgICAgLy8gKioqKioqKiBIYWNrICoqKioqKioqKlxuICAgICAgICAvLyB0aGUgY3VzdG9tIHNlbGVjdCBwbHVnaW4gaXMgcnVubmluZyBzbG93IGVub3VnaCB0aGF0IHRoZSBqcXVlcnkgaXMgZmluZGluZyBtb3JlIHRoYW4gb25lIFwic2VsZWN0ZWRcIiBpdGVtLlxuICAgICAgICAvLyBqcSBpcyBwYXNzaW5nIHRoZSB0ZXh0IG9mIGJvdGggaXRlbXMgdG8gdGhlIGFwaS4gdGhpcyBoYWNrIGp1c3QgZ3JhYnMgdGhlIGxhc3QgaXRlbSBpbiB0aGUgYXJyYXkuXG5cblxuXHRcdFx0XHR2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gJChlLnRhcmdldCkubmV4dCgnLm5pY2Utc2VsZWN0JykuZmluZChcIi5zZWxlY3RlZFwiKS50ZXh0KCk7XG5cdFx0XHRcdCRzdGF0ZVNlbGVjdG9yLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgaWYoJHN0YXRlU2VsZWN0b3IuYXR0cignbmFtZScpLmxlbmd0aCA+IDApe1xuXHRcdFx0XHQkLmdldCggXCIvYXBpL2RlYWxlcmxvb2t1cC9cIisgc2VsZWN0ZWRDb3VudHJ5LCBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRcdFx0XHQkc3RhdGVTZWxlY3Rvci5odG1sKGRhdGEpO1xuICAgICAgICAgICQoJy5jLWtvaC1jb250YWN0LWZvcm0gc2VsZWN0JykubmljZVNlbGVjdCgndXBkYXRlJyk7XG5cdFx0XHRcdH0pO1xuICAgICAgfVxuICAgICAgJCgnLmMta29oLWNvbnRhY3QtZm9ybSBzZWxlY3QnKS5uaWNlU2VsZWN0KCd1cGRhdGUnKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBQaG90byBmaWVsZHMgcHJldmlld1xuXHRcdFx0JGNvbnRhY3RQaG90b3MuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHZhciAkcGhvdG9JbnB1dCA9ICQodGhpcykuZmluZChcImlucHV0W3R5cGU9ZmlsZV1cIik7XG5cdFx0XHRcdGZ1bmN0aW9uIHJlYWRVUkwoaW5wdXQpIHtcblx0XHRcdFx0XHRpZiAoaW5wdXQuZmlsZXMgJiYgaW5wdXQuZmlsZXNbMF0pIHtcblx0XHRcdFx0XHRcdHZhciBwaG90b1ByZXZpZXcgPSAkcGhvdG9JbnB1dC5wYXJlbnQoKS5maW5kKFwiLnByZXZpZXdcIik7XG5cdFx0XHRcdFx0XHRwaG90b1ByZXZpZXcuaHRtbChcIlwiKTtcblx0XHRcdFx0XHRcdHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXHRcdFx0XHRcdFx0cmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBpbWcgPSAkKFwiPGltZyAvPlwiKTtcblx0XHRcdFx0XHRcdFx0aW1nLmF0dHIoXCJzdHlsZVwiLCBcImhlaWdodDo0MXB4O1wiKTtcblx0XHRcdFx0XHRcdFx0aW1nLmF0dHIoXCJzcmNcIiwgZS50YXJnZXQucmVzdWx0KTtcblx0XHRcdFx0XHRcdFx0cGhvdG9QcmV2aWV3LmFwcGVuZChpbWcpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHQkcGhvdG9JbnB1dC5wYXJzbGV5KCkub24oJ2ZpZWxkOnN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgaW5wdXRJRCA9ICRwaG90b0lucHV0LmF0dHIoJ2lkJyk7XG5cdFx0XHRcdFx0dmFyIGlucHV0VGFyZ2V0ID0gJyMnICsgaW5wdXRJRDtcblx0XHRcdFx0XHR2YXIgaW5wdXRWYWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SUQpO1xuXHRcdFx0XHRcdHJlYWRVUkwoaW5wdXRWYWx1ZSk7XG5cdFx0XHRcdFx0JChpbnB1dFRhcmdldCkucGFyZW50KCkuZmluZCgnLmtvaC1waG90by1yZW1vdmUnKS5zaG93KCk7XG5cdFx0XHRcdFx0JGNvbnRhY3RGb3JtLmZpbmQoJyN0ZXJtcycpLnByb3AoJ3JlcXVpcmVkJyx0cnVlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gRm9ybSB2YWxpZGF0aW9uXG5cdFx0XHQkY29udGFjdEZvcm0ucGFyc2xleSh7XG4gICAgICAgIGVycm9yQ2xhc3M6IFwiZXJyb3JcIixcbiAgICAgICAgY2xhc3NIYW5kbGVyOiBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgXHRyZXR1cm4gZWwuJGVsZW1lbnQuY2xvc2VzdCgnZGl2Jyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yc1dyYXBwZXI6ICc8ZGl2IGNsYXNzPVwiZXJyb3ItbWVzc2FnZVwiPjwvZGl2PicsXG4gICAgICAgIGVycm9yVGVtcGxhdGU6ICc8c3Bhbj48L3NwYW4+J1xuICAgIFx0fSk7XG5cblx0XHRcdHdpbmRvdy5QYXJzbGV5LmFkZFZhbGlkYXRvcigndGV4dGZpZWxkJywge1xuXHRcdCAgICByZXF1aXJlbWVudFR5cGU6ICdyZWdleHAnLFxuXHRcdCAgICB2YWxpZGF0ZVN0cmluZzogZnVuY3Rpb24odmFsdWUsIHJlcXVpcmVtZW50KSB7XG5cdFx0ICAgICAgcmV0dXJuIC9eWzAtOUEtWmEteiBfQCcsXFwtXSskL2kudGVzdCh2YWx1ZSlcblx0XHQgICAgfSxcblx0XHQgICAgbWVzc2FnZXM6IHtcblx0XHQgICAgICBlbjogJ0ludmFsaWQgY2hhcmFjdGVycyBkZXRlY3RlZC4nLFxuXHRcdFx0XHRcdCdwdC1icic6ICdDYXJhY3RlcmVzIGludsOhbGlkb3MgZGV0ZWN0YWRvcydcblx0XHQgICAgfVxuXHRcdCAgfSk7XG5cblx0XHRcdHdpbmRvdy5QYXJzbGV5LmFkZFZhbGlkYXRvcigndGV4dGFyZWEnLCB7XG5cdFx0ICAgIHJlcXVpcmVtZW50VHlwZTogJ3JlZ2V4cCcsXG5cdFx0ICAgIHZhbGlkYXRlU3RyaW5nOiBmdW5jdGlvbih2YWx1ZSwgcmVxdWlyZW1lbnQpIHtcblx0XHQgICAgICByZXR1cm4gL15bMC05QS1aYS16IF9AJywuIV8vJFxcLV0rJC9pLnRlc3QodmFsdWUpXG5cdFx0ICAgIH0sXG5cdFx0ICAgIG1lc3NhZ2VzOiB7XG5cdFx0ICAgICAgZW46ICdJbnZhbGlkIGNoYXJhY3RlcnMgZGV0ZWN0ZWQuJyxcblx0XHRcdFx0XHQncHQtYnInOiAnQ2FyYWN0ZXJlcyBpbnbDoWxpZG9zIGRldGVjdGFkb3MnXG5cdFx0ICAgIH1cblx0XHQgIH0pO1xuXG5cdFx0XHR3aW5kb3cuUGFyc2xleS5hZGRWYWxpZGF0b3IoJ2ZpbGVzaXplJywge1xuXHRcdFx0ICB2YWxpZGF0ZVN0cmluZzogZnVuY3Rpb24oX3ZhbHVlLCBtYXhTaXplLCBwYXJzbGV5SW5zdGFuY2UpIHtcblx0XHRcdCAgICB2YXIgZmlsZXMgPSBwYXJzbGV5SW5zdGFuY2UuJGVsZW1lbnRbMF0uZmlsZXM7XG5cdFx0XHQgICAgcmV0dXJuIGZpbGVzLmxlbmd0aCAhPSAxICB8fCBmaWxlc1swXS5zaXplIDw9IG1heFNpemUgKiAxMDI0ICogMTAyNDtcblx0XHRcdCAgfSxcblx0XHRcdCAgcmVxdWlyZW1lbnRUeXBlOiAnaW50ZWdlcicsXG5cdFx0XHQgIG1lc3NhZ2VzOiB7XG5cdFx0XHQgICAgZW46ICdQaG90byBjYW5ub3QgYmUgbGFyZ2VyIHRoYW4gJXMgTUInLFxuXHRcdFx0XHRcdCdwdC1icic6ICdGb3RvIG7Do28gcG9kZSBzZXIgbWFpb3IgcXVlICVzIE1CJ1xuXHRcdFx0ICB9XG5cdFx0XHR9KTtcblxuXHRcdFx0d2luZG93LlBhcnNsZXkuYWRkVmFsaWRhdG9yKCdmaWxldHlwZScsIHtcblx0XHRcdFx0cmVxdWlyZW1lbnRUeXBlOiAnc3RyaW5nJyxcblx0XHRcdFx0dmFsaWRhdGVTdHJpbmc6IGZ1bmN0aW9uICh2YWx1ZSwgcmVxdWlyZW1lbnQsIHBhcnNsZXlJbnN0YW5jZSkge1xuXHRcdFx0XHRcdHZhciBmaWxlID0gcGFyc2xleUluc3RhbmNlLiRlbGVtZW50WzBdLmZpbGVzO1xuXHRcdFx0XHRcdGlmIChmaWxlLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmFyIGFsbG93ZWRNaW1lVHlwZXMgPSByZXF1aXJlbWVudC5yZXBsYWNlKC9cXHMvZywgXCJcIikuc3BsaXQoJywnKTtcblx0XHRcdFx0XHRyZXR1cm4gYWxsb3dlZE1pbWVUeXBlcy5pbmRleE9mKGZpbGVbMF0udHlwZSkgIT09IC0xO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRtZXNzYWdlczoge1xuXHRcdFx0XHRcdGVuOiAnUGhvdG8gbXVzdCBiZSBhIEpQRywgR0lGLCBQTkcgb3IgQk1QJyxcblx0XHRcdFx0XHQncHQtYnInOiAnQSBmb3RvIGRldmUgc2VyIEpQRywgR0lGLCBQTkcgb3IgQk1QJ1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gUmVtb3ZlIHBob3RvXG5cdFx0XHQkKHRoaXMpLm9uKCdjbGljaycsICcua29oLXBob3RvLXJlbW92ZScsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0dmFyIHByZXZJbnB1dCA9ICQodGhpcykucGFyZW50KCkuZmluZChcImlucHV0W3R5cGU9ZmlsZV1cIikuYXR0cignaWQnKTtcblx0XHRcdFx0dmFyIHByZXZJRCBcdFx0PSAkKCcjJyArIHByZXZJbnB1dCk7XG5cdFx0XHRcdHZhciBwcmV2SW1nIFx0PSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5wcmV2aWV3IGltZycpO1xuXHRcdFx0XHR2YXIgdG90YWxJbWdcdD0gJCgnLmtvaC1jb250YWN0LXBob3RvLnBhcnNsZXktc3VjY2VzcycpLmxlbmd0aDtcblx0XHRcdFx0JCh0aGlzKS5oaWRlKCk7XG5cdFx0XHRcdHByZXZJRC5wYXJzbGV5KCkucmVzZXQoKTtcblx0XHRcdFx0cHJldklELnZhbCgnJyk7XG5cdFx0XHRcdHByZXZJbWcucmVtb3ZlKCk7XG5cdFx0XHRcdGlmICh0b3RhbEltZyA8PSAxKSB7XG5cdFx0XHRcdFx0JGNvbnRhY3RGb3JtLmZpbmQoJyN0ZXJtcycpLnByb3AoJ3JlcXVpcmVkJyxmYWxzZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQkY29udGFjdEZvcm0ub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGlmICgkKHRoaXMpLnBhcmVudCgpLmhhc0NsYXNzKCd2LXllcycpKSB7XG5cdFx0XHRcdFx0dmFyIHJlc3BvbnNlID0gZ3JlY2FwdGNoYS5nZXRSZXNwb25zZSh3aWRnZXRJZDEpO1xuXHRcdFx0XHRcdGlmKHJlc3BvbnNlLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHQkY2FwdGNoYUVycm9yLnNob3coKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCQodGhpcykucGFyZW50KCkuaGFzQ2xhc3MoJ3Ytbm8nKSkge1xuXHRcdFx0XHRcdHZhciByZXNwb25zZSA9IGdyZWNhcHRjaGEuZ2V0UmVzcG9uc2Uod2lkZ2V0SWQyKTtcblx0XHRcdFx0XHRpZihyZXNwb25zZS5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0JGNhcHRjaGFFcnJvci5zaG93KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdH0pO1xuXHR9O1xuXG5cdC8qIERlZmluZXMgZnVuY3Rpb25zIGV4cG9zZWQgdGhyb3VnaCBtYW5hZ2VyIG9iamVjdCAqL1xuXHRyZXR1cm4ge1xuXHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uICgpIHtcblx0XHRcdGluaXRDb21wb25lbnRzKCk7XG5cdFx0fSxcblx0XHRvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblx0XHR9XG5cdH07XG59KSgpO1xuXG52YXIgdmVyaWZ5Q2FsbGJhY2sgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuXHQkKFwiLmtvaC1jb250YWN0LWNhcHRjaGEgLmVycm9yLW1lc3NhZ2VcIikuaGlkZSgpO1xufTtcbnZhciB3aWRnZXRJZDE7XG52YXIgd2lkZ2V0SWQyO1xudmFyIGNhcHRjaGFLZXkgPSAkKCcjY2FwdGNoYUtleScpLnZhbCgpO1xudmFyIG9ubG9hZENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG5cdHdpZGdldElkMSA9IGdyZWNhcHRjaGEucmVuZGVyKCdyZWNhcHRjaGExJywge1xuXHRcdCdzaXRla2V5JyA6IGNhcHRjaGFLZXksXG5cdFx0J2NhbGxiYWNrJyA6IHZlcmlmeUNhbGxiYWNrXG4gIH0pO1xuXHR3aWRnZXRJZDIgPSBncmVjYXB0Y2hhLnJlbmRlcigncmVjYXB0Y2hhMicsIHtcblx0XHQnc2l0ZWtleScgOiBjYXB0Y2hhS2V5LFxuXHRcdCdjYWxsYmFjaycgOiB2ZXJpZnlDYWxsYmFja1xuICB9KTtcbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQvLyBleGVjdXRlcyB3aGVuIEhUTUwtRG9jdW1lbnQgaXMgbG9hZGVkIGFuZCBET00gaXMgcmVhZHlcblx0XHRheEtPSC5tYWluLmNvbXBvbmVudE1hbmFnZXIuY29udGFjdEZvcm0uaW5pdGlhbGl6ZSgpO1xuXHR9KTtcblxuXHQkKHdpbmRvdykubG9hZChmdW5jdGlvbigpIHtcblx0XHQvLyBleGVjdXRlcyBhZnRlciB0aGUgd2luZG93IGlzIGZ1bGx5IGxvYWRlZCwgaW5jbHVkaW5nIGFsbCBpbWFnZXMsIGV0Yy5cblx0XHRheEtPSC5tYWluLmNvbXBvbmVudE1hbmFnZXIuY29udGFjdEZvcm0ub25Mb2FkKCk7XG5cdH0pO1xufSk7XG4iXX0=
