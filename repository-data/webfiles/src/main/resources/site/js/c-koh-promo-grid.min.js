/*
 * Copyright Â© 2000-2017 Kohler Company. All Rights Reserved.
 */
var axKOH=axKOH||{};axKOH.main=axKOH.main||{},axKOH.main.promoManager=function(){var componentClass="c-koh-promo-grid",config={breakpoint:768,masonry:{itemSelector:".koh-promo-tile",columnWidth:".koh-promo-tile-sizer",percentPosition:!0},slick:{autoplay:!1,adaptiveHeight:!0,dots:!0,dotsClass:"koh-slider-indicators",arrows:!0,pauseOnHover:!0,pauseOnDotsHover:!0,mobileFirst:!0,slide:".koh-promo-tile"}},toggleMasonry=function($tileCollection,activate){activate?($tileCollection.children(".koh-promo-tile-sizer").length<1&&$tileCollection.prepend('<div class="koh-promo-tile-sizer"></div>'),$tileCollection.imagesLoaded(function(){$tileCollection.masonry(config.masonry)})):($tileCollection.masonry("destroy"),$tileCollection.remove(".koh-promo-tile-sizer"))},timers={},waitForFinalEvent=function(callback,ms,uniqueId){uniqueId||(uniqueId="UNIQUEID"),timers[uniqueId]&&clearTimeout(timers[uniqueId]),timers[uniqueId]=setTimeout(callback,ms)},createSliderControls=function($tileCollection){var $sliderControls=$('<div class="koh-slider-controls"></div>');$sliderControls.insertBefore($tileCollection);var $movePrevious=$('<button class="koh-slider-control previous"><span class="icon"></span><span class="label">Previous</span></button>'),$moveNext=$('<button class="koh-slider-control next"><span class="icon"></span><span class="label">Next</span></button>');return $sliderControls.append($movePrevious),$sliderControls.append($moveNext),$sliderControls},destroySliderControls=function($tileCollection){$tileCollection.prev(".koh-slider-controls").remove()},onResize=function($target,useMasonry,slickConfig){var isMobile=$(window).width()<config.breakpoint,prevSize=$target.attr("data-size");if(!(isMobile&&"mobile"===prevSize||!isMobile&&"desktop"===prevSize))if(isMobile){useMasonry&&prevSize&&toggleMasonry($target,!1);var $sliderControls=createSliderControls($target);slickConfig.appendArrows=$sliderControls,slickConfig.appendDots=$sliderControls,slickConfig.prevArrow=$sliderControls.children(".koh-slider-control.previous"),slickConfig.nextArrow=$sliderControls.children(".koh-slider-control.next"),$target.slick(slickConfig),$target.attr("data-size","mobile")}else prevSize&&$target.hasClass("slick-initialized")&&($target.slick("unslick"),destroySliderControls($target)),useMasonry&&toggleMasonry($target,!0),$target.attr("data-size","desktop")},initPromos=function(){var $components=$("."+componentClass),$stackedComponents=$components.not(".m-koh-slideshow"),$sliderComponents=$components.filter(".m-koh-slideshow");$stackedComponents.each(function(){var $component=$(this);if($component.hasClass("v-koh-scattered")){var $container=$component.children(".koh-promo-content"),$tileCollection=$container.children(".koh-promo-tiles");toggleMasonry($tileCollection,!0)}}),$sliderComponents.each(function(index){var $component=$(this),$container=$component.children(".koh-promo-content"),$tileCollection=$container.children(".koh-promo-tiles"),useMasonry=$component.hasClass("v-koh-scattered");onResize($tileCollection,useMasonry,config.slick),$(window).resize({target:$tileCollection,masonry:useMasonry,config:config.slick},function(e){var $target=e.data.target,masonry=e.data.masonry,config=e.data.config;waitForFinalEvent(function(){onResize($target,masonry,config)},500,"promo"+index)})})},initPromoVideos=function(){var $components=$("."+componentClass);$components.each(function(componentIndex){var $component=$(this),$tiles=$component.find(".koh-promo-tile");$tiles.each(function(tileIndex){var $tile=$(this),$videoIcons=$tile.find(".koh-video-icon");if($videoIcons.length>0){var $videoLink=$tile.children("a").first(),videoURL=$videoLink.attr("href");if(videoURL){var $videoPanel=$('<div class="koh-video-panel"><iframe width="560" height="315" src="'+videoURL+'" frameborder="0" allowfullscreen></iframe></div>');$videoPanel.insertAfter($videoLink);var remodalID="PromoVideo"+componentIndex+tileIndex;initAsModal($videoLink,$videoPanel,remodalID)}}})})},initAsModal=function($button,$panel,remodalID){$panel.data("remodal-id",remodalID),$panel.prepend('<button data-remodal-action="close" class="remodal-close"></button>'),$panel.attr("data-koh-component",componentClass),$panel.addClass(componentClass+"-modal");var $remodalPanel=$panel.remodal({hashTracking:!0,closeOnCancel:!0,closeOnEscape:!0,closeOnOutsideClick:!0,modifier:""});$button.data("remodal-target",remodalID),$button.click({target:$remodalPanel},function(e){e.preventDefault(),e.stopPropagation();var $target=e.data.target;$target.open()})};return{initialize:function(){initPromos(),initPromoVideos()}}}(),$(function(){$(window).load(function(){axKOH.main.promoManager.initialize()})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImMta29oLXByb21vLWdyaWQuanMiXSwibmFtZXMiOlsiYXhLT0giLCJtYWluIiwicHJvbW9NYW5hZ2VyIiwiY29tcG9uZW50Q2xhc3MiLCJjb25maWciLCJicmVha3BvaW50IiwibWFzb25yeSIsIml0ZW1TZWxlY3RvciIsImNvbHVtbldpZHRoIiwicGVyY2VudFBvc2l0aW9uIiwic2xpY2siLCJhdXRvcGxheSIsImFkYXB0aXZlSGVpZ2h0IiwiZG90cyIsImRvdHNDbGFzcyIsImFycm93cyIsInBhdXNlT25Ib3ZlciIsInBhdXNlT25Eb3RzSG92ZXIiLCJtb2JpbGVGaXJzdCIsInNsaWRlIiwidG9nZ2xlTWFzb25yeSIsIiR0aWxlQ29sbGVjdGlvbiIsImFjdGl2YXRlIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJwcmVwZW5kIiwiaW1hZ2VzTG9hZGVkIiwicmVtb3ZlIiwidGltZXJzIiwid2FpdEZvckZpbmFsRXZlbnQiLCJjYWxsYmFjayIsIm1zIiwidW5pcXVlSWQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiY3JlYXRlU2xpZGVyQ29udHJvbHMiLCIkc2xpZGVyQ29udHJvbHMiLCIkIiwiaW5zZXJ0QmVmb3JlIiwiJG1vdmVQcmV2aW91cyIsIiRtb3ZlTmV4dCIsImFwcGVuZCIsImRlc3Ryb3lTbGlkZXJDb250cm9scyIsInByZXYiLCJvblJlc2l6ZSIsIiR0YXJnZXQiLCJ1c2VNYXNvbnJ5Iiwic2xpY2tDb25maWciLCJpc01vYmlsZSIsIndpbmRvdyIsIndpZHRoIiwicHJldlNpemUiLCJhdHRyIiwiYXBwZW5kQXJyb3dzIiwiYXBwZW5kRG90cyIsInByZXZBcnJvdyIsIm5leHRBcnJvdyIsImhhc0NsYXNzIiwiaW5pdFByb21vcyIsIiRjb21wb25lbnRzIiwiJHN0YWNrZWRDb21wb25lbnRzIiwibm90IiwiJHNsaWRlckNvbXBvbmVudHMiLCJmaWx0ZXIiLCJlYWNoIiwiJGNvbXBvbmVudCIsInRoaXMiLCIkY29udGFpbmVyIiwiaW5kZXgiLCJyZXNpemUiLCJ0YXJnZXQiLCJlIiwiZGF0YSIsImluaXRQcm9tb1ZpZGVvcyIsImNvbXBvbmVudEluZGV4IiwiJHRpbGVzIiwiZmluZCIsInRpbGVJbmRleCIsIiR0aWxlIiwiJHZpZGVvSWNvbnMiLCIkdmlkZW9MaW5rIiwiZmlyc3QiLCJ2aWRlb1VSTCIsIiR2aWRlb1BhbmVsIiwiaW5zZXJ0QWZ0ZXIiLCJyZW1vZGFsSUQiLCJpbml0QXNNb2RhbCIsIiRidXR0b24iLCIkcGFuZWwiLCJhZGRDbGFzcyIsIiRyZW1vZGFsUGFuZWwiLCJyZW1vZGFsIiwiaGFzaFRyYWNraW5nIiwiY2xvc2VPbkNhbmNlbCIsImNsb3NlT25Fc2NhcGUiLCJjbG9zZU9uT3V0c2lkZUNsaWNrIiwibW9kaWZpZXIiLCJjbGljayIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwib3BlbiIsImluaXRpYWxpemUiLCJsb2FkIl0sIm1hcHBpbmdzIjoiOzs7QUFNQSxHQUFJQSxPQUFRQSxTQUVaQSxPQUFNQyxLQUFPRCxNQUFNQyxTQUVuQkQsTUFBTUMsS0FBS0MsYUFBZSxXQUN0QixHQUFJQyxnQkFBaUIsbUJBRWpCQyxRQUNBQyxXQUFZLElBQ1pDLFNBQ0lDLGFBQWMsa0JBQ2RDLFlBQWEsd0JBQ2JDLGlCQUFpQixHQUVyQkMsT0FDSUMsVUFBVSxFQUNWQyxnQkFBZ0IsRUFDaEJDLE1BQU0sRUFDTkMsVUFBVyx3QkFDWEMsUUFBUSxFQUNSQyxjQUFjLEVBQ2RDLGtCQUFrQixFQUNsQkMsYUFBYSxFQUNiQyxNQUFPLG9CQUlYQyxjQUFnQixTQUFVQyxnQkFBaUJDLFVBQ3ZDQSxVQUVJRCxnQkFBZ0JFLFNBQVMseUJBQXlCQyxPQUFTLEdBQzNESCxnQkFBZ0JJLFFBQVEsNENBRzVCSixnQkFBZ0JLLGFBQWEsV0FDekJMLGdCQUFnQmYsUUFBUUYsT0FBT0UsYUFHbkNlLGdCQUFnQmYsUUFBUSxXQUV4QmUsZ0JBQWdCTSxPQUFPLDJCQUkzQkMsVUFFQUMsa0JBQW9CLFNBQVVDLFNBQVVDLEdBQUlDLFVBQ3ZD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QVksYUFBZVgsZUFBaUJHLFNBQ2hEUyxhQUFZTixXQUFZRyxZQUFhRSxrQkFRckRDLFlBQWMsU0FBVUMsUUFBU0MsT0FBUUgsV0FDekNHLE9BQU9oQixLQUFLLGFBQWNhLFdBQzFCRyxPQUFPL0QsUUFBUSx1RUFDZitELE9BQU9wQyxLQUFLLHFCQUFzQmpELGdCQUNsQ3FGLE9BQU9DLFNBQVN0RixlQUFpQixTQUVqQyxJQUFJdUYsZUFBZ0JGLE9BQU9HLFNBQ3ZCQyxjQUFjLEVBQ2RDLGVBQWUsRUFDZkMsZUFBZSxFQUNmQyxxQkFBcUIsRUFDckJDLFNBQVUsSUFJZFQsU0FBUWYsS0FBSyxpQkFBa0JhLFdBQy9CRSxRQUFRVSxPQUNKM0IsT0FBUW9CLGVBQ1QsU0FBVW5CLEdBQ1RBLEVBQUUyQixpQkFDRjNCLEVBQUU0QixpQkFDRixJQUFJdEQsU0FBVTBCLEVBQUVDLEtBQUtGLE1BQ3JCekIsU0FBUXVELFNBS2hCLFFBQ0lDLFdBQVksV0FDUjNDLGFBQ0FlLHVCQUtacEMsRUFBRSxXQUNFQSxFQUFFWSxRQUFRcUQsS0FBSyxXQUVYdEcsTUFBTUMsS0FBS0MsYUFBYW1HIiwiZmlsZSI6ImMta29oLXByb21vLWdyaWQubWluLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IMKpIDIwMDAtMjAxNyBLb2hsZXIgQ29tcGFueS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICovXHJcblxyXG4vLyBKYXZhU2NyaXB0IERvY3VtZW50XHJcblxyXG52YXIgYXhLT0ggPSBheEtPSCB8fCB7fTtcclxuXHJcbmF4S09ILm1haW4gPSBheEtPSC5tYWluIHx8IHt9O1xyXG5cclxuYXhLT0gubWFpbi5wcm9tb01hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGNvbXBvbmVudENsYXNzID0gXCJjLWtvaC1wcm9tby1ncmlkXCI7XHJcblxyXG4gICAgdmFyIGNvbmZpZyA9IHtcclxuICAgICAgICBicmVha3BvaW50OiA3NjgsXHJcbiAgICAgICAgbWFzb25yeToge1xyXG4gICAgICAgICAgICBpdGVtU2VsZWN0b3I6ICcua29oLXByb21vLXRpbGUnLFxyXG4gICAgICAgICAgICBjb2x1bW5XaWR0aDogJy5rb2gtcHJvbW8tdGlsZS1zaXplcicsXHJcbiAgICAgICAgICAgIHBlcmNlbnRQb3NpdGlvbjogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2xpY2s6IHtcclxuICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxyXG4gICAgICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcclxuICAgICAgICAgICAgZG90czogdHJ1ZSxcclxuICAgICAgICAgICAgZG90c0NsYXNzOiAna29oLXNsaWRlci1pbmRpY2F0b3JzJyxcclxuICAgICAgICAgICAgYXJyb3dzOiB0cnVlLFxyXG4gICAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsXHJcbiAgICAgICAgICAgIHBhdXNlT25Eb3RzSG92ZXI6IHRydWUsXHJcbiAgICAgICAgICAgIG1vYmlsZUZpcnN0OiB0cnVlLFxyXG4gICAgICAgICAgICBzbGlkZTogJy5rb2gtcHJvbW8tdGlsZSdcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0b2dnbGVNYXNvbnJ5ID0gZnVuY3Rpb24gKCR0aWxlQ29sbGVjdGlvbiwgYWN0aXZhdGUpIHtcclxuICAgICAgICBpZiAoYWN0aXZhdGUpIHtcclxuICAgICAgICAgICAgLy8gYWRkIHNpemVyIGRpdiB0aGF0IG1hc29ucnkgbmVlZHMgdG8gc2l6ZSB0aGluZ3MgcHJvcGVybHlcclxuICAgICAgICAgICAgaWYgKCR0aWxlQ29sbGVjdGlvbi5jaGlsZHJlbihcIi5rb2gtcHJvbW8tdGlsZS1zaXplclwiKS5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgICAgICAkdGlsZUNvbGxlY3Rpb24ucHJlcGVuZCgnPGRpdiBjbGFzcz1cImtvaC1wcm9tby10aWxlLXNpemVyXCI+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICR0aWxlQ29sbGVjdGlvbi5pbWFnZXNMb2FkZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHRpbGVDb2xsZWN0aW9uLm1hc29ucnkoY29uZmlnLm1hc29ucnkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkdGlsZUNvbGxlY3Rpb24ubWFzb25yeSgnZGVzdHJveScpO1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgc2l6ZXIgd2hlbiB3ZSdyZSBub3QgZG9pbmcgbWFzb25yeVxyXG4gICAgICAgICAgICAkdGlsZUNvbGxlY3Rpb24ucmVtb3ZlKFwiLmtvaC1wcm9tby10aWxlLXNpemVyXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHRpbWVycyA9IHt9O1xyXG5cclxuICAgIHZhciB3YWl0Rm9yRmluYWxFdmVudCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgbXMsIHVuaXF1ZUlkKSB7XHJcbiAgICAgICAgaWYgKCF1bmlxdWVJZCkge1xyXG4gICAgICAgICAgICB1bmlxdWVJZCA9IFwiVU5JUVVFSURcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRpbWVyc1t1bmlxdWVJZF0pIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyc1t1bmlxdWVJZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aW1lcnNbdW5pcXVlSWRdID0gc2V0VGltZW91dChjYWxsYmFjaywgbXMpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgY3JlYXRlU2xpZGVyQ29udHJvbHMgPSBmdW5jdGlvbiAoJHRpbGVDb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgdmFyICRzbGlkZXJDb250cm9scyA9ICQoJzxkaXYgY2xhc3M9XCJrb2gtc2xpZGVyLWNvbnRyb2xzXCI+PC9kaXY+Jyk7XHJcbiAgICAgICAgJHNsaWRlckNvbnRyb2xzLmluc2VydEJlZm9yZSgkdGlsZUNvbGxlY3Rpb24pO1xyXG5cclxuICAgICAgICB2YXIgJG1vdmVQcmV2aW91cyA9ICQoJzxidXR0b24gY2xhc3M9XCJrb2gtc2xpZGVyLWNvbnRyb2wgcHJldmlvdXNcIj48c3BhbiBjbGFzcz1cImljb25cIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJsYWJlbFwiPlByZXZpb3VzPC9zcGFuPjwvYnV0dG9uPicpO1xyXG4gICAgICAgIHZhciAkbW92ZU5leHQgPSAkKCc8YnV0dG9uIGNsYXNzPVwia29oLXNsaWRlci1jb250cm9sIG5leHRcIj48c3BhbiBjbGFzcz1cImljb25cIj48L3NwYW4+PHNwYW4gY2xhc3M9XCJsYWJlbFwiPk5leHQ8L3NwYW4+PC9idXR0b24+Jyk7XHJcbiAgICAgICAgJHNsaWRlckNvbnRyb2xzLmFwcGVuZCgkbW92ZVByZXZpb3VzKTtcclxuICAgICAgICAkc2xpZGVyQ29udHJvbHMuYXBwZW5kKCRtb3ZlTmV4dCk7XHJcblxyXG4gICAgICAgIHJldHVybiAkc2xpZGVyQ29udHJvbHM7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBkZXN0cm95U2xpZGVyQ29udHJvbHMgPSBmdW5jdGlvbiAoJHRpbGVDb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgJHRpbGVDb2xsZWN0aW9uLnByZXYoXCIua29oLXNsaWRlci1jb250cm9sc1wiKS5yZW1vdmUoKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIG9uUmVzaXplID0gZnVuY3Rpb24gKCR0YXJnZXQsIHVzZU1hc29ucnksIHNsaWNrQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGlzTW9iaWxlID0gKCQod2luZG93KS53aWR0aCgpIDwgY29uZmlnLmJyZWFrcG9pbnQpO1xyXG4gICAgICAgIHZhciBwcmV2U2l6ZSA9ICR0YXJnZXQuYXR0cihcImRhdGEtc2l6ZVwiKTtcclxuXHJcbiAgICAgICAgaWYgKChpc01vYmlsZSAmJiBwcmV2U2l6ZSA9PT0gXCJtb2JpbGVcIikgfHwgKCFpc01vYmlsZSAmJiBwcmV2U2l6ZSA9PT0gXCJkZXNrdG9wXCIpKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIHN0aWxsIG9uIHRoZSBzYW1lIHNpZGUgb2YgdGhlIGJyZWFrcG9pbnQgdGhhdCB3ZSB3ZXJlIFxyXG4gICAgICAgICAgICAvLyBiZWZvcmUsIGFuZCB0aGlzIGlzIG5vdCBmaXJzdCBsb2FkLCBkb24ndCByZS1pbml0XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpc01vYmlsZSkge1xyXG4gICAgICAgICAgICAvLyB0dXJuIG9mZiBtYXNvbnJ5IGlmIHdlJ3JlIHVzaW5nIGl0XHJcbiAgICAgICAgICAgIGlmICh1c2VNYXNvbnJ5ICYmIHByZXZTaXplKSB7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVNYXNvbnJ5KCR0YXJnZXQsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyB0dXJuIG9uIHNsaWNrXHJcbiAgICAgICAgICAgIHZhciAkc2xpZGVyQ29udHJvbHMgPSBjcmVhdGVTbGlkZXJDb250cm9scygkdGFyZ2V0KTtcclxuICAgICAgICAgICAgc2xpY2tDb25maWcuYXBwZW5kQXJyb3dzID0gJHNsaWRlckNvbnRyb2xzO1xyXG4gICAgICAgICAgICBzbGlja0NvbmZpZy5hcHBlbmREb3RzID0gJHNsaWRlckNvbnRyb2xzO1xyXG4gICAgICAgICAgICBzbGlja0NvbmZpZy5wcmV2QXJyb3cgPSAkc2xpZGVyQ29udHJvbHMuY2hpbGRyZW4oXCIua29oLXNsaWRlci1jb250cm9sLnByZXZpb3VzXCIpO1xyXG4gICAgICAgICAgICBzbGlja0NvbmZpZy5uZXh0QXJyb3cgPSAkc2xpZGVyQ29udHJvbHMuY2hpbGRyZW4oXCIua29oLXNsaWRlci1jb250cm9sLm5leHRcIik7XHJcblxyXG4gICAgICAgICAgICAkdGFyZ2V0LnNsaWNrKHNsaWNrQ29uZmlnKTtcclxuICAgICAgICAgICAgLy8gc2F2ZSB3aGF0IHNpemUgd2UgaW5pdGlhbGl6ZWQgYXQgbGFzdFxyXG4gICAgICAgICAgICAkdGFyZ2V0LmF0dHIoXCJkYXRhLXNpemVcIiwgXCJtb2JpbGVcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdHVybiBvZmYgc2xpY2tcclxuICAgICAgICAgICAgaWYgKHByZXZTaXplKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHRhcmdldC5oYXNDbGFzcygnc2xpY2staW5pdGlhbGl6ZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQuc2xpY2soJ3Vuc2xpY2snKTtcclxuICAgICAgICAgICAgICAgICAgICBkZXN0cm95U2xpZGVyQ29udHJvbHMoJHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdHVybiBvbiBtYXNvbnJ5IGlmIHdlJ3JlIHVzaW5nIGl0XHJcbiAgICAgICAgICAgIGlmICh1c2VNYXNvbnJ5KSB7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVNYXNvbnJ5KCR0YXJnZXQsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICR0YXJnZXQuYXR0cihcImRhdGEtc2l6ZVwiLCBcImRlc2t0b3BcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaW5pdFByb21vcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBMb2NhdGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgY29tcG9uZW50XHJcbiAgICAgICAgdmFyICRjb21wb25lbnRzID0gJChcIi5cIiArIGNvbXBvbmVudENsYXNzKTtcclxuXHJcbiAgICAgICAgLy8gRmlsdGVyIGxpc3RzIGZvciBzbGlkZXJzIHZzIHN0YWNrZWRcclxuICAgICAgICB2YXIgJHN0YWNrZWRDb21wb25lbnRzID0gJGNvbXBvbmVudHMubm90KFwiLm0ta29oLXNsaWRlc2hvd1wiKTtcclxuICAgICAgICB2YXIgJHNsaWRlckNvbXBvbmVudHMgPSAkY29tcG9uZW50cy5maWx0ZXIoXCIubS1rb2gtc2xpZGVzaG93XCIpO1xyXG5cclxuICAgICAgICAvLyBJZiB0aGUgY29tcG9uZW50IHNldHRpbmdzIGluZGljYXRlIHRoYXQgaXQgc2hvdWxkIGJlIHN0YWNrZWQgYXQgbW9iaWxlLCBrZWVwIGl0IHNpbXBsZTpcclxuICAgICAgICAvLyBKdXN0IGFjdGl2YXRlIHRoZSBNYXNvbnJ5IGZvciBTY2F0dGVyZWQgYW5kIGJlIGRvbmVcclxuICAgICAgICAkc3RhY2tlZENvbXBvbmVudHMuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciAkY29tcG9uZW50ID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgaWYgKCRjb21wb25lbnQuaGFzQ2xhc3MoXCJ2LWtvaC1zY2F0dGVyZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkY29udGFpbmVyID0gJGNvbXBvbmVudC5jaGlsZHJlbihcIi5rb2gtcHJvbW8tY29udGVudFwiKTtcclxuICAgICAgICAgICAgICAgIHZhciAkdGlsZUNvbGxlY3Rpb24gPSAkY29udGFpbmVyLmNoaWxkcmVuKFwiLmtvaC1wcm9tby10aWxlc1wiKTtcclxuICAgICAgICAgICAgICAgIHRvZ2dsZU1hc29ucnkoJHRpbGVDb2xsZWN0aW9uLCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBJZiB0aGUgY29tcG9uZW50IHNldHRpbmdzIGluZGljYXRlIHRoYXQgaXQgc2hvdWxkIGJlIHNsaWRlciBhdCBtb2JpbGUsIHRoaXMgbmVlZHMgbW9yZSBzdGVwczpcclxuICAgICAgICAkc2xpZGVyQ29tcG9uZW50cy5lYWNoKGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgJGNvbXBvbmVudCA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgIHZhciAkY29udGFpbmVyID0gJGNvbXBvbmVudC5jaGlsZHJlbihcIi5rb2gtcHJvbW8tY29udGVudFwiKTtcclxuICAgICAgICAgICAgdmFyICR0aWxlQ29sbGVjdGlvbiA9ICRjb250YWluZXIuY2hpbGRyZW4oXCIua29oLXByb21vLXRpbGVzXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHVzZU1hc29ucnkgPSAkY29tcG9uZW50Lmhhc0NsYXNzKFwidi1rb2gtc2NhdHRlcmVkXCIpO1xyXG4gICAgICAgICAgICBvblJlc2l6ZSgkdGlsZUNvbGxlY3Rpb24sIHVzZU1hc29ucnksIGNvbmZpZy5zbGljayk7XHJcblxyXG4gICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKHtcclxuICAgICAgICAgICAgICAgIHRhcmdldDogJHRpbGVDb2xsZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgbWFzb25yeTogdXNlTWFzb25yeSxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzogY29uZmlnLnNsaWNrXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9IGUuZGF0YS50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWFzb25yeSA9IGUuZGF0YS5tYXNvbnJ5O1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IGUuZGF0YS5jb25maWc7XHJcblxyXG4gICAgICAgICAgICAgICAgd2FpdEZvckZpbmFsRXZlbnQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9uUmVzaXplKCR0YXJnZXQsIG1hc29ucnksIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MDAsIFwicHJvbW9cIiArIGluZGV4KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBpbml0UHJvbW9WaWRlb3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyICRjb21wb25lbnRzID0gJChcIi5cIiArIGNvbXBvbmVudENsYXNzKTtcclxuXHJcbiAgICAgICAgJGNvbXBvbmVudHMuZWFjaChmdW5jdGlvbiAoY29tcG9uZW50SW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyICRjb21wb25lbnQgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICB2YXIgJHRpbGVzID0gJGNvbXBvbmVudC5maW5kKFwiLmtvaC1wcm9tby10aWxlXCIpO1xyXG5cclxuICAgICAgICAgICAgJHRpbGVzLmVhY2goZnVuY3Rpb24gKHRpbGVJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICR0aWxlID0gJCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIGRldGVybWluZSBpZiB0aGlzIHRpbGUgaXMgYSB2aWRlbyB0aWxlXHJcbiAgICAgICAgICAgICAgICB2YXIgJHZpZGVvSWNvbnMgPSAkdGlsZS5maW5kKFwiLmtvaC12aWRlby1pY29uXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCR2aWRlb0ljb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgJHZpZGVvTGluayA9ICR0aWxlLmNoaWxkcmVuKFwiYVwiKS5maXJzdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2aWRlb1VSTCA9ICR2aWRlb0xpbmsuYXR0cihcImhyZWZcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWRlb1VSTCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgZGl2cyB0byBiZSB2aWRlbyBtb2RhbHMgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkdmlkZW9QYW5lbCA9ICQoJzxkaXYgY2xhc3M9XCJrb2gtdmlkZW8tcGFuZWxcIj48aWZyYW1lIHdpZHRoPVwiNTYwXCIgaGVpZ2h0PVwiMzE1XCIgc3JjPVwiJyArIHZpZGVvVVJMICsgJ1wiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT48L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHZpZGVvUGFuZWwuaW5zZXJ0QWZ0ZXIoJHZpZGVvTGluayk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb2RhbElEID0gXCJQcm9tb1ZpZGVvXCIgKyBjb21wb25lbnRJbmRleCArIHRpbGVJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdEFzTW9kYWwoJHZpZGVvTGluaywgJHZpZGVvUGFuZWwsIHJlbW9kYWxJRCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyogSGVscGVyIEZ1bmN0aW9ucyAqL1xyXG4gICAgdmFyIGluaXRBc01vZGFsID0gZnVuY3Rpb24gKCRidXR0b24sICRwYW5lbCwgcmVtb2RhbElEKSB7XHJcbiAgICAgICAgJHBhbmVsLmRhdGEoXCJyZW1vZGFsLWlkXCIsIHJlbW9kYWxJRCk7XHJcbiAgICAgICAgJHBhbmVsLnByZXBlbmQoJzxidXR0b24gZGF0YS1yZW1vZGFsLWFjdGlvbj1cImNsb3NlXCIgY2xhc3M9XCJyZW1vZGFsLWNsb3NlXCI+PC9idXR0b24+Jyk7XHJcbiAgICAgICAgJHBhbmVsLmF0dHIoXCJkYXRhLWtvaC1jb21wb25lbnRcIiwgY29tcG9uZW50Q2xhc3MpO1xyXG4gICAgICAgICRwYW5lbC5hZGRDbGFzcyhjb21wb25lbnRDbGFzcyArIFwiLW1vZGFsXCIpO1xyXG5cclxuICAgICAgICB2YXIgJHJlbW9kYWxQYW5lbCA9ICRwYW5lbC5yZW1vZGFsKHtcclxuICAgICAgICAgICAgaGFzaFRyYWNraW5nOiB0cnVlLFxyXG4gICAgICAgICAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLFxyXG4gICAgICAgICAgICBjbG9zZU9uRXNjYXBlOiB0cnVlLFxyXG4gICAgICAgICAgICBjbG9zZU9uT3V0c2lkZUNsaWNrOiB0cnVlLFxyXG4gICAgICAgICAgICBtb2RpZmllcjogJydcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gTWFrZSB0aGUgYnV0dG9uIGFsbCBidXR0b24teSBhbmQgY2xpY2steVxyXG4gICAgICAgICRidXR0b24uZGF0YShcInJlbW9kYWwtdGFyZ2V0XCIsIHJlbW9kYWxJRCk7XHJcbiAgICAgICAgJGJ1dHRvbi5jbGljayh7XHJcbiAgICAgICAgICAgIHRhcmdldDogJHJlbW9kYWxQYW5lbFxyXG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgdmFyICR0YXJnZXQgPSBlLmRhdGEudGFyZ2V0O1xyXG4gICAgICAgICAgICAkdGFyZ2V0Lm9wZW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyogRGVmaW5lcyBmdW5jdGlvbnMgZXhwb3NlZCB0aHJvdWdoIG1hbmFnZXIgb2JqZWN0ICovXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaW5pdFByb21vcygpO1xyXG4gICAgICAgICAgICBpbml0UHJvbW9WaWRlb3MoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHdpbmRvdykubG9hZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gZXhlY3V0ZXMgd2hlbiBIVE1MLURvY3VtZW50IGlzIGxvYWRlZCBhbmQgRE9NIGlzIHJlYWR5XHJcbiAgICAgICAgYXhLT0gubWFpbi5wcm9tb01hbmFnZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXX0=
